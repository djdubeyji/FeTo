var _slicedToArray=function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,a){var t=[],r=!0,s=!1,i=void 0;try{for(var g,n=e[Symbol.iterator]();!(r=(g=n.next()).done);r=!0){t.push(g.value);if(a&&t.length===a)break}}catch(e){s=!0;i=e}finally{try{!r&&n.return&&n.return()}finally{if(s)throw i}}return t}(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(){"use strict";var e=require("internal/browser-metrics"),a=require("jquery"),t=require("jira/jquery/deferred"),r="jira.dashboard",s=1e4,i="loaded",g="timeout",n=/\/plugins\/servlet\/gadgets\/ifr\?/,d=/^(?:[^:]+:)?[./]*[^/:#?]+/,o={"jira-dashboard-items/assigned-to-me":"gadget.jira.assigned.to.me","jira-dashboard-items/bubble-chart-dashboard-item":"gadget.jira.bubble.chart","jira-dashboard-items/createdvsresolved":"gadget.jira.created.resolved","jira-dashboard-items/favourite-filters":"gadget.jira.favourite.filters","jira-dashboard-items/filter-results":"gadget.jira.filter.results","jira-dashboard-items/in-progress":"gadget.jira.in.progress","jira-dashboard-items/labels":"gadget.jira.labels","jira-dashboard-items/piechart":"gadget.jira.piechart","jira-dashboard-items/sprint-days-remaining":"gadget.jira.sprint.days","jira-dashboard-items/sprint-health":"gadget.jira.sprint.health","jira-dashboard-items/stats":"gadget.jira.stats","jira-dashboard-items/two-dimensional-stats":"gadget.jira.two.dimensional.stats","jira-dashboard-items/voted":"gadget.jira.voted","jira-dashboard-items/watched":"gadget.jira.watched","rest/gadgets/1.0/g/com.atlassian.bonfire.plugin:bonfire-test-sessions-gadget/gadget/bonfire-sessions-gadget.xml":"gadget.rest.bonfire.sessions","rest/gadgets/1.0/g/com.atlassian.jira.ext.calendar:issuescalendar-gadget/templates/plugins/jira/portlets/calendar/gadget/calendar-gadget.xml":"gadget.rest.jiraext.issues.calendar","rest/gadgets/1.0/g/com.atlassian.jira.ext.charting:firstresponse-gadget/com/atlassian/jira/ext/charting/gadget/firstresponse-gadget.xml":"gadget.rest.jiraext.first.response","rest/gadgets/1.0/g/com.atlassian.jira.ext.charting:numberoftimesinstatus-gadget/com/atlassian/jira/ext/charting/gadget/numberoftimesinstatus-gadget.xml":"gadget.rest.jiraext.times.in.status","rest/gadgets/1.0/g/com.atlassian.jira.ext.charting:timeinstatus-gadget/com/atlassian/jira/ext/charting/gadget/timeinstatus-gadget.xml":"gadget.rest.jiraext.issues.calendar.time.in.status","rest/gadgets/1.0/g/com.atlassian.jira.ext.charting:workloadpie-gadget/com/atlassian/jira/ext/charting/gadget/workloadpie-gadget.xml":"gadget.rest.jiraext.workload","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:average-age-chart-gadget/gadgets/average-age-gadget.xml":"gadget.rest.jira.average.age","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:heat-map-gadget/gadgets/heatmap-gadget.xml":"gadget.rest.jira.heat.map","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:project-gadget/gadgets/project-gadget.xml":"gadget.rest.jira.project","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:recently-created-chart-gadget/gadgets/recently-created-gadget.xml":"gadget.rest.jira.recently.created","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:resolution-time-gadget/gadgets/resolution-time-gadget.xml":"gadget.rest.jira.resolution.time","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:road-map-gadget/gadgets/roadmap-gadget.xml":"gadget.rest.jira.roadmap","rest/gadgets/1.0/g/com.atlassian.jira.gadgets:time-since-chart-gadget/gadgets/timesince-gadget.xml":"gadget.rest.jira.timesince","rest/gadgets/1.0/g/com.atlassian.jirafisheyeplugin:crucible-charting-gadget/gadgets/crucible-charting-gadget.xml":"gadget.rest.crucible.charting","rest/gadgets/1.0/g/com.atlassian.jirafisheyeplugin:fisheye-charting-gadget/gadgets/fisheye-charting-gadget.xml":"gadget.rest.fisheye.charting","rest/gadgets/1.0/g/com.atlassian.jirafisheyeplugin:fisheye-recent-commits-gadget/gadgets/fisheye-recent-commits-gadget.xml":"gadget.rest.fisheye.recent","rest/gadgets/1.0/g/com.atlassian.jirawallboard.atlassian-wallboard-plugin:spacer-gadget/gadgets/spacerGadget.xml":"gadget.rest.wallboard.spacer","rest/gadgets/1.0/g/com.atlassian.streams.streams-jira-plugin:activitystream-gadget/gadgets/activitystream-gadget.xml":"gadget.rest.wallboard.spacer","rest/gadgets/1.0/g/com.pyxis.greenhopper.jira:greenhopper-gadget-rapid-view/gadgets/greenhopper-rapid-view.xml":"gadget.rest.greenhopper.rapid.view","rest/gadgets/1.0/g/com.pyxis.greenhopper.jira:greenhopper-gadget-sprint-burndown/gadgets/greenhopper-sprint-burndown.xml":"gadget.rest.greenhopper.sprint.burndown","rest/gadgets/1.0/g/com.pyxis.greenhopper.jira:greenhopper-gadget-version-report/gadgets/greenhopper-version-report.xml":"gadget.rest.greenhopper.version"};function l(e,a,t){(a.loadingPromises||[]).forEach((function(a){a.resolve({src:e,status:t})}));a.loadingPromises=[]}var c=void 0,m=function(){if(c)return c;var e={};p().filter((function(e){return n.test(e.renderedGadgetUrl)})).forEach((function(a){e[h(a.renderedGadgetUrl)]={key:"jira.gadgets.iframe",specId:a.gadgetSpecUrl,loadingPromises:[],renderedMark:null}}));c=e;return e};function u(e){var r=e.map((function(e){return function(e){var r=t(),n=m()[h(e.src)];if(n){n.loadingPromises.push(r);n.isOnLoadMarked&&l(e.src,n,i)}else if(window.document&&"complete"===window.document.readyState)r.resolve({src:e.src,status:i});else{var d=void 0,o=function t(s){clearTimeout(d);a(window).off("load",t);r.resolve({src:e.src,status:s})};d=setTimeout((function(){o(g)}),s);a(window).on("load",(function(){o(i)}))}return r}(e)}));return a.when.apply(a,r)}function f(){var e=a.Deferred();a((function(){var t=a("#dashboard");0===t.length&&e.reject();if(t.hasClass("initializing")){t.on("initialized",(function a(){t.off("initialized",a);e.resolve()}))}else e.resolve()}));return e.promise()}function p(){var e=void 0,t=a("dashboard")[0];try{e=JSON.parse(t.getAttribute("layouts")).layouts}catch(e){return{}}var r=e.filter((function(e){return e.active}))[0];return r&&r.gadgets&&r.gadgets.length?r.gadgets:{}}function h(e){return"string"==typeof e?e.replace(/#[^#]*$/,""):e}var j=function(e,a){if(a){var t=m()[h(a.gadgetUrl)];if(t){t.isOnLoadMarked=!0;t.loadingPromises.length>0&&l(a.gadgetUrl,t,i)}}},v=function(){var e=!0,a=!1,t=void 0;try{for(var r,s=Object.entries(m())[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var i=r.value,n=_slicedToArray(i,2),d=n[0],o=n[1];o&&o.loadingPromises.length>0&&l(d,o,g)}}catch(e){a=!0;t=e}finally{try{!e&&s.return&&s.return()}finally{if(a)throw t}}};a(document).on("gadget-loaded",j);var b=void 0;f().then((function(){b=setTimeout(v,s)}));function y(e){if(!e||/^\s+$/.test(e))return"[empty]";var a=m()[h(e)];if(a)return a.specId;var t=d.exec(e);return t?t[0]:"[masked]"}var x=f(),w=[],k=void 0;x.pipe((function(){performance&&(k=Math.round(performance.now()))}));w.push((function(){return"number"==typeof k?{dashboardInitialized:k}:{}}));function S(t){e.end({key:r,reporters:w.concat((function(){var e=p().map((function(e){return(a=e.amdModule||e.gadgetSpecUrl,o[a])||"gadget.unknown";var a})).reduce((function(e,a){e.hasOwnProperty(a)?e[a]+=1:e[a]=1;return e}),{});return e}))});b&&clearTimeout(b);a(document).off("gadget-loaded",j);var s=!0,i=!1,n=void 0;try{for(var d,l=Object.entries(t)[Symbol.iterator]();!(s=(d=l.next()).done);s=!0){var c=d.value,m=_slicedToArray(c,2)[1];m.status===g&&console.log("dashboard.metrics","iframe onload timed out: "+y(m.src))}}catch(e){i=!0;n=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw n}}}x.pipe((function(){t=a("meta[name=ajs-dashboard-id]").attr("content"),e.start({key:r,isInitial:!0,entityId:t});var t;return u(a("#dashboard").find(".dashboard-item-content").find("iframe[src!='about:blank']").get())})).done((function(){S(arguments)}))}();