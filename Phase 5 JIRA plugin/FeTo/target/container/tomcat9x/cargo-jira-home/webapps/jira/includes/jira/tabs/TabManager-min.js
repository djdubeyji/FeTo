define("jira/tabs/tab-manager",["jira/util/events","jira/util/events/types","jira/util/events/reasons","jira/common/page","jira/tabs/tab-manager/util","jquery","exports"],(function(a,t,e,r,n,i,o){"use strict";o.navigationTabs=function(){var o,s,l,c,d,f,u={},b={filterTabSelector:r.mainContentCssSelector,tabsSelector:"ul.vertical.tabs li",tabsLinksSelector:"ul.vertical.tabs li a",requestParams:"decorator=none&contentOnly=true",stateRequestParams:"decorator=none&contentOnly=true&updateState=true",activeTabClass:"active",loadedTabClass:"loaded",tabParam:"filterView"},m=function(r,n,o){var d=i(r).find("a"),m=f.getTabParamFromUrl(o);if(f.getTabParamFromUrl(l.find("a").attr("href"))!==m&&o&&(l.get(0)!==r||o)){l&&l.length&&l.removeClass(b.activeTabClass).removeClass(b.loadedTabClass);l=i(r).addClass("active");if(c&&c.get(0)&&4!==c.get(0).readyState&&c.get(0).abort){i.isFunction(c.hideThrobber)&&c.hideThrobber();c.get(0).abort()}s.html(i("<h2 />").text(d.attr("title")));c=i(i.ajax({method:"get",dataType:"html",url:o,data:b.requestParams,success:function(r){s.empty();s.html(r);n||f.saveHistoryItem(f.constructCompleteUrl(d.attr("href")));o=d.attr("id"),u[o]&&u[o]instanceof Array&&i(u[o]).each((function(){this()}));var o;l.addClass(b.loadedTabClass);a.trigger(t.NEW_CONTENT_ADDED,[s,e.tabUpdated])}}).fail((function(a){if(401===a.status)window.location.reload();else if("abort"!==a.statusText){var t=a.responseText&&a.responseText.match(/<body[^>]*>([\S\s]*)<\/body[^>]*>/);t&&t.length>0&&s.html('<div style="padding:0 20px">'+t[1]+"</div>")}}))).throbber({target:r})}},h=function(a){var t,e=b.getTabRegEx,r=a.match(e);i(d).each((function(){var a=i(this).find("a").attr("href").match(e);r&&r.length>0&&a[0]===r[0]&&(t=this)}));return t};window.addEventListener("popstate",(function(){f&&function(a){var t=i([]);if(f.getTabParamFromUrl(l.find("a").attr("href"))!==a){a&&""!==a?t=h(a):""===a&&(t=o);t&&m(t,!0,i(t).find("a").attr("href"))}}(f.getTabParamFromUrl(window.location.href))}));return{getActiveTab:function(){return l},getProjectTab:function(){return s},addLoadEvent:function(a,t){u[a]=u[a]||[];i.isFunction(t)&&u[a].push(t)},_getTabManagerUtil:function(){return f},_getNavigateToTabFunc:function(){return m},init:function(a){i.extend(b,a);b.getTabRegEx=new RegExp(b.tabParam+"=[^&]*");f=new n(window.location.href,b.tabParam,b.getTabRegEx);s=i(b.filterTabSelector);d=i(b.tabsSelector).each((function(){if(i(this).hasClass(b.activeTabClass)){(l=i(this)).addClass(b.loadedTabClass);o=l}}));var t=h(window.location.href);if(!window.location.href.match(b.getTabRegEx)&&o){var e=i(o).find("a").attr("href");f.replaceHistoryItem(f.updateInitialUrl(e))}var r=f.getTabParamFromUrl(window.location.href);if(r&&t&&l&&f.getTabParamFromUrl(l.find("a").attr("href"))!==r){var c=i(t).find("a").attr("href");m(i(t),!0,c)}i(b.tabsLinksSelector).click((function(a){var t=i(this).attr("href"),e=h(t);if(e){m(e,!1,t);a.preventDefault()}}));a&&a.customInit&&a.customInit()}}}()}));AJS.namespace("jira.app.manageShared",null,require("jira/tabs/tab-manager"));AJS.namespace("JIRA.TabManager",null,require("jira/tabs/tab-manager"));