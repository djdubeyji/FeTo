AJS.test.require(["jira.webresources:reindex","jira.webresources:momentjs","jira.webresources:init-on-dcl"],(function(){"use strict";require(["jquery"],(function(e){module("SnapshotRecoveryView",{setup:function(){this.sandbox=sinon.sandbox.create({useFakeServer:!0});this.SmartAjax={makeRequest:this.sandbox.stub().returns((new e.Deferred).resolve())};this.context=AJS.test.mockableModuleContext();this.SnapshotAutoComplete=this.sandbox.spy();this.context.mock("jira/autocomplete/snapshot-autocomplete",this.SnapshotAutoComplete);this.context.mock("jira/ajs/ajax/smart-ajax",this.SmartAjax);this.SnapshotRecoveryView=this.context.require("jira/index/snapshot-recovery-view")},teardown:function(){this.sandbox.restore()}});test("Initializes autocomplete",(function(){new this.SnapshotRecoveryView;sinon.assert.calledOnce(this.SnapshotAutoComplete)}));test("Populates snapshot details",(function(){new this.SnapshotRecoveryView;sinon.assert.calledTwice(this.SmartAjax.makeRequest)}));test("When snapshot created, updates snapshot details",(function(){(new this.SnapshotRecoveryView).pollCreateStatus();sinon.assert.calledThrice(this.SmartAjax.makeRequest)}))}))}));