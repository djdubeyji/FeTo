AJS.test.require(["jira.webresources:searchers"],(function(){"use strict";var e=this,t=require("jira/util/formatter"),o=require("jira/searchers/element/project-picker-options"),s=["test 1","test 2","3 test"];module("projectPickerOptions",{setup:function(){e.sandbox=sinon.sandbox.create();e.sandbox.stub(t,"format",(function(){return"TEXT"}));e.createProject=function(e,t){return{id:t,avatar:"http://url/avatar/"+t,name:e,html:"test project <strong>"+e+"</strong> (<strong>"+e+"</strong>)"}};e.createProjects=function(t){return{projects:s.map(e.createProject),total:t||s.length}}},teardown:function(){e.sandbox.restore()}});test("should setup picker options",(function(){var e=o({});equal(e.maxInlineResultsDisplayed,100,"maxInlineResultsDisplayed is defined by common options");equal(e.maxResultsDisplayedPerGroup,100,"maxResultsDisplayedPerGroup is defined by common options")}));test("should setup ajax options",(function(){var e=o({});ok(e.ajaxOptions,"ajaxOptions defined");ok(e.ajaxOptions.url,"REST endpoint path defined");ok(e.ajaxOptions.data.maxResults>=1,"maxResults query param is set to equal or higher than 1");ok(!e.query,"Uses debouncing");ok("function"==typeof e.ajaxOptions.formatResponse,"formatResponse method defined")}));test("should keep input options",(function(){var e={test1:"test 1 option",test2:2,test3:!1},t=o(e);equal(t.test1,e.test1,"keep string property");equal(t.test2,e.test2,"keep numeric property");equal(t.test3,e.test3,"keep boolean property")}));test("should format response",(function(){var t=e.createProjects(),s=o({}).ajaxOptions.formatResponse(t);t.projects.forEach((function(e){return ok(s[0].items().some((function(t){return t.value()===e.id&&t.icon()===e.avatar&&t.html()===e.html&&t.label()==="test project "+e.name+" ("+e.name+")"})),"should format response for project id:"+e.id+", name:"+e.name)}));ok(!0===s[0].fetchedThroughAjaxCall(),"marked as ajax call response")}));test("should include footer text when number of projects returned was trimmed",(function(){var t=e.createProjects(5),s=o({}).ajaxOptions.formatResponse(t);ok("TEXT"===s[0].footerText(),"footer text is set")}));test("should omit footer text when all projects were returned",(function(){var t=e.createProjects(),s=o({}).ajaxOptions.formatResponse(t);ok(!s[0].footerText(),"footer text is not set")}))}));