define("jira/jquery/plugins/livestamp/time",["jira/util/formatter","jquery","jira/moment","jira/util/data/meta"],(function(e,t,n,o){"use strict";var r={};function a(e,t){this.key=e;this.isAge=t}var i=o.getBoolean("date-relativize");a.types={};for(var u,l=["shortAge","longAge","fullAge","short","long","full","timestamp"],m=0,s=l.length;m<s;m++){u=l[m];a.types[u]=new a(u,-1!==u.toLowerCase().indexOf("age"))}var c={};r.FormatType=a;function d(t,n,o){return t in c?e.format(c[t],o):null}function g(e){return e.clone().hours(0).minutes(0).seconds(0).milliseconds(0)}function f(e,t){return Math.floor(t.diff(e,"minutes",!0))}function v(e,t){var n=t.diff(e,"hours",!0);return Math.round(n)}function x(e,t){return Math.floor(t.diff(e,"days",!0))}function A(e,t){var n=function(e){switch(e.key){case"short":case"shortAge":return"ll";case"long":case"longAge":return"LL";case"full":case"fullAge":case"timestamp":return"LLL";default:return null}}(t);return e.format(n)}function h(e,t,o){if(e<=(o=o||n())){if(e>o.clone().subtract("m",1))return d("aMomentAgo");if(e>o.clone().subtract("m",2))return d("oneMinuteAgo");if(e>o.clone().subtract("m",50))return d("xMinutesAgo",0,f(e,o));if(e>o.clone().subtract("m",90))return d("oneHourAgo");if(function(e,t){var n=g(e);return n.clone().subtract("d",1)<=t&&t<n}(o,e)&&e<o.clone().subtract("h",5))return d("oneDayAgo");if(e>o.clone().subtract("d",1))return d("xHoursAgo",0,v(e,o));if(e>o.clone().subtract("d",7))return d("xDaysAgo",0,Math.max(x(e,o),2));if(e>o.clone().subtract("d",8))return d("oneWeekAgo")}else{if(e<o.clone().add("m",1))return d("inAMoment");if(e<o.clone().add("m",2))return d("inOneMinute");if(e<o.clone().add("m",50))return d("inXMinutes",0,f(o,e));if(e<o.clone().add("m",90))return d("inOneHour");if(function(e,t){var n=g(e).add("d",1),o=n.clone().add("d",1);return n<=t&&t<o}(o,e)&&e>o.clone().add("h",5))return d("inOneDay");if(e<o.clone().add("d",1))return d("inXHours",0,v(o,e));if(e<o.clone().add("d",7))return d("inXDays",0,Math.max(x(o,e),2));if(e<o.clone().add("d",8))return d("inOneWeek")}return A(e,t)}r.formatDate=function(e,t,n){return e&&t?(i||n)&&t.isAge?h(e,t):A(e,t):null};r.setRelativeTranslations=function(e){for(var t in e)c[t]=e[t]};r.restoreDefaultRelativeTranslations=function(){this.setRelativeTranslations({inAMoment:e.I18n.getText("common.date.relative.in.a.moment"),inOneMinute:e.I18n.getText("common.date.relative.in.one.minute"),inXMinutes:e.I18n.getText("common.date.relative.in.x.minutes"),inOneHour:e.I18n.getText("common.date.relative.in.one.hour"),inXHours:e.I18n.getText("common.date.relative.in.x.hours"),inOneDay:e.I18n.getText("common.date.relative.in.one.day"),inXDays:e.I18n.getText("common.date.relative.in.x.days"),inOneWeek:e.I18n.getText("common.date.relative.in.one.week"),aMomentAgo:e.I18n.getText("common.date.relative.a.moment.ago"),oneMinuteAgo:e.I18n.getText("common.date.relative.one.minute.ago"),xMinutesAgo:e.I18n.getText("common.date.relative.x.minutes.ago"),oneHourAgo:e.I18n.getText("common.date.relative.one.hour.ago"),xHoursAgo:e.I18n.getText("common.date.relative.x.hours.ago"),oneDayAgo:e.I18n.getText("common.date.relative.one.day.ago"),xDaysAgo:e.I18n.getText("common.date.relative.x.days.ago"),oneWeekAgo:e.I18n.getText("common.date.relative.one.week.ago")})};r.restoreDefaultRelativeTranslations();r.formatDateWithRelativeAge=h;r.formatDateWithFormatString=A;return r}));AJS.namespace("JIRA.Time",null,require("jira/jquery/plugins/livestamp/time"));