define("jira/project/project-edit-key",["jira/analytics","jira/util/key-code","jira/util/formatter","jira/lib/class","jquery","aui/flag","underscore","aui/inline-dialog2"],(function(i,e,t,n,a,l,r){"use strict";return n.extend({init:function(i,e){this.options=r.defaults(e||{},{flagShowDelay:600});var t=a(i),n=this;this.warningFlag=null;this.$input=t.find("#project-edit-key");this.$initialKey=t.find("#edit-project-original-key");this.$keyEdited=t.find("#edit-project-key-edited");this.updateFlagDebounced=r.throttle(this.updateFlag,this.options.flagShowDelay,{leading:!1,trailing:!0});this.updateFlag();t.find("#project-edit-key").on("remove",(function(){n.cleanupFlag()}))},checkModified:function(){this.updateFlagDebounced();this.$keyEdited.val(this._hasBeenModified().toString())},updateFlag:function(){this._hasBeenModified()?null==this.warningFlag&&this.createFlag():this.cleanupFlag()},cleanupFlag:function(){if(null!=this.warningFlag){this.warningFlag.close();this.warningFlag=null}},createFlag:function(){this.warningFlag=l({type:"warning",title:"",body:JIRA.Templates.Project.ChangeTriggeredFlag.fieldRevertWarning({message:t.I18n.getText("admin.projects.edit.project.key.warning.message"),revertMessage:t.I18n.getText("admin.projects.edit.project.warning.cancel")})});var i=this;a(this.warningFlag).find(".cancel").click((function(e){e.preventDefault();i._revert()}));a(this.warningFlag).find(".aui-close-button").click((function(){i.updateFlagDebounced=function(){};i.warningFlag=null}));a(this.warningFlag).find(".aui-close-button").keypress((function(t){if(t.which===e.ENTER||t.which===e.SPACE){i.updateFlagDebounced=function(){};i.warningFlag=null}}))},_hasBeenModified:function(){return this.$initialKey.val()!==this.$input.val()},_revert:function(){this.$input.val(this.$initialKey.val());this.updateFlag();i.send({name:"jira.administration.projectdetails.projectkeyupdate.cancelled"})}})}));AJS.namespace("ProjectEditKey",null,require("jira/project/project-edit-key"));