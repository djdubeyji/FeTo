define("jira/dialog/accessible-dialog",["jquery","aui/dialog"],(function(e,t){"use strict";var i=function(e){this.options=e;t.call(this,e);e&&a(this.getCurrentPage(),e.onPageLoadFocusBehavior)};i.prototype=Object.assign({},t.prototype);function a(e,t){e.handleFocusOnLoad=t||i.OnPageLoadFocusBehavior.Title}i.prototype.removeHiddenPageMenu=function(e){e.find(".dialog-page-menu[style*='display: none']").remove()};i.prototype.getCurrentPage=function(){return this.page[this.curpage]};i.prototype.get$CurrentPageTitle=function(){return this.getCurrentPage().element.find(".dialog-title")};i.prototype._handleDialogHide=function(){document.removeEventListener("keydown",this.handleFocus);this.options&&this.options.$elementToFocusOnClose&&this.options.$elementToFocusOnClose.focus()};i.prototype._focusFirstInteractiveElement=function(e){e.find(":focusable:not([tabindex='-1']):first").focus()};i.prototype._handleFocusOnPageLoad=function(){this.getCurrentPage().handleFocusOnLoad(this)};i.prototype.show=function(){var t,a=this.popup.element;a.addClass(i.ClassNames.Dialog);this.popup.show();AJS.trigger("show.dialog",{dialog:this});this.handleFocus=(t=this.id,function(i){if("Tab"===i.key){var a=document.activeElement,o=e("#"+t).find(".dialog-components:visible").find(":focusable:not([tabindex='-1'])"),n=o[0],s=o[o.length-1],r=a===n||e(a).hasClass("dialog-title"),l=e(a).hasClass("dialog-title"),d=a===s;if(i.shiftKey&&(r||l)){s.focus();i.preventDefault()}else if(!i.shiftKey&&d){n.focus();i.preventDefault()}}});document.addEventListener("keydown",this.handleFocus);a.attr({"aria-hidden":!1,"aria-modal":!0,role:"dialog"});var o=this.get$CurrentPageTitle();a.attr("aria-labelledby",o.attr("id"));this.removeHiddenPageMenu(a);setTimeout(function(){this._handleFocusOnPageLoad()}.bind(this));return this};i.prototype.hide=function(){this.popup.hide();AJS.trigger("hide.dialog",{dialog:this});this._handleDialogHide();return this};i.prototype.remove=function(){t.prototype.remove.call(this);this._handleDialogHide()};i.prototype.addHeader=function(t,i,a){var o=this.getCurrentPage();o.header&&o.header.remove();var n=e("<div class='dialog-header'></div>"),s=e("<h1 class='dialog-title' tabindex='-1'></h1>").text(t||"");i&&s.addClass(i);var r=o.element.attr("id");!a&&r?a=r+"-title":a||r||(a=this.popup.element.attr("id")+"-page-"+this.curpage+"-title");s.attr("id",a);this.popup.element.attr("aria-labelledby",a);n.append(s);o.element.prepend(n);o.header=n;o.recalcSize();return this};i.prototype._makePageAccessible=function(){var e=this.getCurrentPage().element,t=this.get$CurrentPageTitle();this.popup.element.attr("aria-labelledby",t.attr("id"));this.removeHiddenPageMenu(e);this._handleFocusOnPageLoad()};i.prototype.prevPage=function(){t.prototype.prevPage.call(this);this._makePageAccessible();return this};i.prototype.nextPage=function(){t.prototype.nextPage.call(this);this._makePageAccessible();return this};i.prototype.gotoPage=function(e){t.prototype.gotoPage.call(this,e);this._makePageAccessible();return this};i.prototype.addPage=function(e,i){t.prototype.addPage.call(this,e);a(this.getCurrentPage(),i);return this};i.prototype.updateHeight=function(){t.prototype.updateHeight.call(this);this._handleFocusOnPageLoad()};i.ClassNames={Dialog:"jira-accessible-dialog"};i.OnPageLoadFocusBehavior={Title:function(e){e.get$CurrentPageTitle().focus()},FirstInteractiveElement:function(e){e._focusFirstInteractiveElement(e.getCurrentPage().element)}};return i}));AJS.namespace("JIRA.AccessibleDialog",null,require("jira/dialog/accessible-dialog"));