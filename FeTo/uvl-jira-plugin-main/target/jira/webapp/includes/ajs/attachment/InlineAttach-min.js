define("jira/attachment/inline-attach",["jira/util/urls","jira/util/formatter","jira/lib/class","jira/xsrf","jira/util/navigator","jquery","wrm/context-path"],(function(t,e,r,n,i,o,a){"use strict";var s,l,u,h,c,d,p,f,m,g=a(),x=r.extend({init:function(t){var e=o(t);x.AjaxPresenter.isSupported(e)?new x.AjaxPresenter(e):new x.FormPresenter(e)}});o.extend(x,{MAX_UPLOADS:2,DISPLAY_WAIT:600,rescope:function(t,e){return t?e?o.proxy(t,e):t:o.noop},copyArrayLike:function(t){return o.makeArray(t)},Renderers:{container:function(){return o("<div class='field-group'/>")}}});x.Presenter=r.extend({init:function(){this.cancelled=!1;this.running=[];this.waiting=[]},_addUpload:function(t){if(!this.cancelled)if(this.running.length>=x.MAX_UPLOADS)this.waiting.push(t);else{this.running.push(t);t.upload()}return this.running.length>0},_finishUpload:function(t){if(!this.cancelled){x.Presenter.removeFromArray(this.waiting,t);if(x.Presenter.removeFromArray(this.running,t)&&this.waiting.length>0){var e=this.waiting.shift();this.running.push(e);e.upload()}}return this.running.length>0},_cancel:function(){this.cancelled=!0;var t,e=x.copyArrayLike(this.waiting);for(t=0;t<e.length;t++)e[t].abort();var r=x.copyArrayLike(this.running);for(t=0;t<r.length;t++)r[t].abort();this.waiting=[];this.running=[]}});o.extend(x.Presenter,{removeFromArray:function(t,e){var r=o.inArray(e,t);return r>=0?t.splice(r,1):null}});x.FormPresenter=x.Presenter.extend({init:function(t){this._super();this.form=new x.Form(new x.FileInput(t,!1));this.form.fileSelector.onChange(o.proxy(this._attach,this));this.form.onCancel(o.proxy(this._cancel,this))},_attach:function(t){this.form.clearErrors();if(!this.cancelled){var e=this.form,r=this._createSubmitData(),n=e.cloneFileInput();e.fileSelector.clear();var i=e.addStaticProgress(t),o=new x.Timer((function(){!this.cancelled&&i.show()}),this),a=new x.FormUpload({$input:n,url:x.FormPresenter.DEFAULT_URL,params:r,scope:this,before:function(){!this.cancelled&&i.start()},success:function(r){this.cancelled||(r.id&&r.name?e.addTemporaryFileCheckbox(r.id,r.name,i):r.errorMsg?e.addErrorWithFileName(r.errorMsg,t,i):e.addError(x.Text.tr("upload.error.bad.response",t),i))},error:function(r){this.cancelled||(r.indexOf("SecurityTokenMissing")>=0?e.addError(x.Text.tr("upload.xsrf.timeout",t),i):e.addError(x.Text.tr("upload.error.unknown",t),i))},after:function(){o.cancel();i.remove();this.cancelled||this._finishUpload(a)||e.enable()}});i.onCancel((function(){a.abort()}));if(this._addUpload(a)){o.schedule(x.DISPLAY_WAIT);e.disable()}e.fileSelector.focus()}},_cancel:function(){this._super();this.form.enable()},_createSubmitData:function(){var t={atl_token:this.form.getAtlToken(),formToken:this.form.getFormToken()};if(this.form.issueId)t.id=this.form.issueId;else{if(!this.form.projectId)throw"Unable to find either an issueId or projectId to submit the attachment to.";t.create=!0;t.projectId=this.form.projectId}return t}});x.FormPresenter.DEFAULT_URL=g+"/secure/AttachTemporaryFile.jspa?decorator=none";x.AjaxPresenter=x.Presenter.extend({init:function(t){this._super();this.form=new x.Form(new x.FileInput(t,!0));this.form.fileSelector.onChange(o.proxy(this._attach,this));this.form.onCancel(o.proxy(this._cancel,this))},_attach:function(t){this.form.clearErrors();if(!this.cancelled){t&&t.length>0&&(t=this._checkAndFilterFiles(t))&&this._uploadFiles(t);this.form.fileSelector.clear().focus()}},_checkAndFilterFiles:function(t){if(t.length>x.AjaxPresenter.MAX_SELECTED_FILES){this.form.addError(x.Text.tr("upload.error.too.many.files",t.length,x.AjaxPresenter.MAX_SELECTED_FILES));return null}for(var e=this.form.maxSize,r=[],n=0;n<t.length;n++)try{var i=t[n];if(0===i.size)this.form.addError(x.Text.tr("upload.empty.file",i.name));else if(e>0&&i.size>e){var o=x.Text.fileSize(e,i.size);this.form.addError(x.Text.tr("upload.too.big",i.name,o[1],o[0]))}else r.push({name:i.name,size:i.size,file:i})}catch(t){this.form.addError(x.AjaxUpload.getClientErrorMessage(t,i))}return 0===r.length?null:r},_createSubmitData:function(){var t={atl_token:this.form.getAtlToken(),formToken:this.form.getFormToken()};if(this.form.issueId)t.issueId=this.form.issueId;else{if(!this.form.projectId)throw"Unable to find either an issueId or projectId to submit the attachment to.";t.projectId=this.form.projectId}return t},_uploadFiles:function(t){var e=this.form,r=this._createSubmitData(),n=this,i=!1;o.each(t,(function(){var t=e.addProgress(this),a=this,s=new x.Timer((function(){n.cancelled||t.show()})),l=new x.AjaxUpload({file:a.file,params:o.extend({filename:a.name,size:a.size},r),scope:n,url:x.AjaxPresenter.DEFAULT_URL,before:function(){!this.cancelled&&t.start()},progress:function(e){!this.cancelled&&t.update(e)},success:function(r,n){if(!this.cancelled)if(201===n)void 0!==r.id&&void 0!==r.name?e.addTemporaryFileCheckbox(r.id,r.name,t,a.file):e.addError(x.Text.tr("upload.error.bad.response",a.name),t);else{r.token&&e.setAtlToken(r.token);r.errorMessage?e.addErrorWithFileName(r.errorMessage,a.name,t):e.addError(this._getErrorFromStatus(n,a),t)}},error:function(r,n){if(!this.cancelled)if(n<0)e.addError(r,t);else{var i=this._getErrorFromStatus(n,a);i?e.addError(i,t):e.addError(x.Text.tr("upload.error.unknown",a.name),t)}},after:function(){s.cancel();t.finish().remove();this.cancelled||this._finishUpload(l)||e.enable()}});t.onCancel((function(){l.abort()}));if(n._addUpload(l)){i=!0;s.schedule(x.DISPLAY_WAIT)}}));i&&this.form.disable()},_getErrorFromStatus:function(t,e){return 0===t?x.Text.tr("upload.error.server.no.reply",e.name):400===t?x.Text.tr("upload.error.badrequest",e.name):401===t?x.Text.tr("upload.error.auth",e.name):x.Text.tr("upload.error.unknown.status",e.name,t)},_cancel:function(){this._super();this.form.enable()}});o.extend(x.AjaxPresenter,{DEFAULT_URL:g+"/rest/internal/2/AttachTemporaryFile",MAX_SELECTED_FILES:100,isSupported:function(t){return!!(t&&t[0]&&t[0].files)&&x.AjaxUpload.isSupported()}});x.FileInput=r.extend({init:function(t,e){this.$element=t;this.$container=t.parent();if(e&&void 0!==this.$element[0].files){this.$element.attr("multiple","multiple");this.multiple=!0}else this.multiple=!1},clear:function(){this.$element.val("");return this},getFiles:function(){return this.$element[0].files},hasFiles:function(){return this.getFiles().length>0},onChange:function(t){var e=this;this.$element.change((function(){e.multiple?t.call(e,this.files):t.call(e,e.getFileName())}));return this},focus:function(){if(this._isIE()){var t=this.$element;setTimeout((function(){t.focus()}),0)}else this.$element.focus();return this},cloneInput:function(){var t=this.$element;t.replaceWith(this.$element=t.clone(!0));t.unbind();return t},getFileName:(s=/^c:\\fakepath\\(?!$)/i,function(){var t=this.$element.val();t=t.replace(s,"");this._isIE()&&t.indexOf("\\")>=0&&(t=t.substring(t.lastIndexOf("\\")+1));return t}),_isIE:function(){return i.isIE()&&i.majorVersion()<11},before:function(t){if(t){t.$element&&(t=t.$element);this.$container.before(t)}}});l={showPercentage:!1,height:"2px"},u=0,x.ProgressBar=r.extend({init:function(){var t=this.$element=this._renderers.container();this.$progress=this._renderers.progress().appendTo(t);this.$progress.progressBar(0,l);this.hidden=!0;this.old=0},value:function(t){t>100?t=100:t<0&&(t=0);if(this.hidden){this.$progress.show();this.hidden=!1}if(this.old!==t){this.$progress.progressBar(t,l);t>=100&&this.$progress.fadeOut();this.old=t}},_renderers:{container:function(){return o("<div>").addClass("file-progress")},progress:function(){return o("<div>").attr("id","upload-progress-"+u++).hide()}}});x.UploadProgress=r.extend({init:function(t){var e=this.$element=x.Renderers.container().hide(),r=this.progress=new x.ProgressBar,n=this._renders.content(t.name);this.$content=n.$content;this.$cancel=n.$cancel;e.append(n.$element).append(r.$element);this.total=t.size;this.current=0;this.name=t.name;this.timer=new x.Timer(this._update,this);this.rateNumerator=0;this.rateDenominator=0;this._title(x.Text.tr("upload.progress.title.waiting"))},start:function(){this.started=this._now();this.startedSize=0;return this},update:function(t){this.timer.cancel();return this._update(t)},_update:function(t){var e=this._now();if(void 0===t)t=this.current;else if(t!==this.current){this.lastUpdate=e;this.current=t}var r,n,i=x.Text,o=Math.min(100,Math.round(t/this.total*100)),a=i.currentOutOfTotalSize(t,this.total);this.progress.value(o);var s=(e-this.started)/1e3;if(s>=2){this.startedSize>0&&this._addRate((t-this.startedSize)/s);this.started=e;this.startedSize=t}var l=this._calcRate();if(t>=x.UploadProgress.DATA_MIN&&l>0){var u=Math.max(1,(this.total-t)/l);r=i.rate(l);n=i.time(u)}if(e-this.lastUpdate>=x.UploadProgress.STALLED_TIMEOUT){this._content(i.tr("upload.file.stalled",this.name));r?this._title(i.tr("upload.progress.title.known.stalled",r,a)):this._title(i.tr("upload.progress.title.unknown.stalled",a))}else if(r){this._title(i.tr("upload.progress.title.known",r,a,n));this._content(i.tr("upload.file.remaining",this.name,n))}else{this._title(a);this._content(this.name)}t<this.total&&this.timer.schedule(x.UploadProgress.UPLOAD_REFRESH);return this},finish:function(){this.progress.value(100);this.timer.cancel();return this},onCancel:function(t){var e=this;this.$cancel.click((function(r){r.preventDefault();t.call(e)}));return this},remove:function(){this.$element.remove();return this},hide:function(){this.$element.hide();return this},show:function(){this.$element.fadeIn();return this},_title:function(t){this.$element.attr("title",t);return this},_content:function(t){this.$content.text(t);return this},_addRate:function(t){var e=x.UploadProgress.WEIGHT;this.rateNumerator=this.rateNumerator*e+t;this.rateDenominator=this.rateDenominator*e+1},_calcRate:function(){if(0===this.rateDenominator)return 0;var t=this.rateNumerator/this.rateDenominator;return Math.abs(t)<.005?0:t},_now:function(){return(new Date).getTime()},_renders:{content:function(t){var e=x.Text.tr("upload.file.waiting",t),r=o("<div class='loading file' />"),n=o("<span />").text(e),i=o("<a href='#' />").text(x.Text.tr("upload.cancel"));r.append(n).append(" ").append(i);return{$element:r,$content:n,$cancel:i}}}});o.extend(x.UploadProgress,{STALLED_TIMEOUT:1e4,UPLOAD_REFRESH:2e3,DATA_MIN:20480,WEIGHT:.7});x.UnknownProgress=r.extend({init:function(t){var e=this._renders.content(t);this.$element=e.$element;this.$cancel=e.$cancel;this.$content=e.$content;this.fileName=t;this._title(x.Text.tr("upload.progress.title.waiting"))},remove:function(){this.$element.remove();return this},hide:function(){this.$element.hide();return this},show:function(){this.$element.fadeIn();return this},start:function(){this._title(x.Text.tr("upload.progress.title.running"));this._content(this.fileName);return this},onCancel:function(t){var e=this;this.$cancel.click((function(r){r.preventDefault();t.call(e)}));return this},_title:function(t){this.$element.attr("title",t);return this},_content:function(t){this.$content.text(t);return this},_renders:{content:function(t){var e=x.Text.tr("upload.file.waiting",t),r=o("<a href='#' />").text(x.Text.tr("upload.cancel")),n=o("<div class='loading file' />"),i=o("<span />").text(e);n.append(i).append(" ").append(r);return{$element:x.Renderers.container().append(n),$cancel:r,$content:i}}}});x.Form=r.extend({init:function(t){this.fileSelector=t;this.$form=t.$element.closest("form");this.maxSize=parseInt(this.$form.find("#attach-max-size").text()||o("#attach-max-size").text());if(isNaN(this.maxSize))throw"Unable to find maximum upload size on form.";var e=!1,r=parseInt(this.$form.find(":input[name=id]").val());if(!isNaN(r)){e=!0;this.issueId=r}r=parseInt(this.$form.find(":input[name=pid]").val());if(!isNaN(r)){e=!0;this.projectId=r}if(!e)throw"Unable to find either an issueId or projectId to submit the attachment to."},getAtlToken:function(){var e=this.$form.find("input[name='atl_token']");return e.length>0?e.val():t.atl_token()},setAtlToken:function(t){var e=this.$form.find("input[name='atl_token']");e.length>0?e.val(t):n.updateTokenOnPage(t);return this},getFormToken:function(){var t=this.$form.find("input[name='formToken']");return t.length>0?t.val():null},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},addProgress:function(t){var e=new x.UploadProgress(t);this._addElement(e.$element);return e},addStaticProgress:function(t){var e=new x.UnknownProgress(t);this._addElement(e.$element);return e},addTemporaryFileCheckbox:function(t,e,r,n){var i=this.addLocalThumbnailImage(e,n),a=x.Renderers.container(),s=o("<label>").attr("for","filetoconvert-"+t).text(e),l=o("<input type='checkbox' class='checkbox' name='filetoconvert' checked='checked'>").attr({id:"filetoconvert-"+t,value:t,title:x.Text.tr("upload.checkbox.title")});a.append(l).append(s);i&&a.append(o("<br/>")).append(i);a.hide();this._replaceElement(a,r);return this},addLocalThumbnailImage:function(t,e){var r=null;window.URL=window.webkitURL||window.URL;if(e&&window.URL&&window.URL.createObjectURL){if(e.type.match(/image.*/)){var n=this,i=t+" - "+x.Text.fileSize(e.size)+" - "+e.type,a=document.createElement("img");a.title=i;a.alt=i;a.onload=function(){var t=n.getAspectRatio(100,100,a.width,a.height);a.width=Math.round(a.width/t);a.height=Math.round(a.height/t);r.show();window.URL.revokeObjectURL(a.src)};a.src=window.URL.createObjectURL(e);r=o(a).hide()}}return r},getAspectRatio:function(t,e,r,n){return r>t?Math.round(r/t):n>e?Math.round(n/e):1},addErrorWithFileName:function(t,e,r){-1===t.indexOf(e)&&(t=x.Text.tr("upload.error.server",e,t));return this.addError(t,r)},addError:function(t,e){var r=x.Renderers.container();r.addClass("error").append(o("<div>").text(t)).hide();this._replaceElement(r,e);return r},clearErrors:function(){this.$form.find("div.error").remove();return this},cloneFileInput:function(){return this.fileSelector.cloneInput()},onCancel:function(t){this.$form.find("a.cancel").click(o.proxy(t,this));return this},_getFormSubmits:function(){return this.$form.find("input[type=submit]")},_addElement:function(t){this.fileSelector.before(t)},_replaceElement:function(t,e){e&&e.$element?e.$element.replaceWith(t):this._addElement(t);t.fadeIn()}});x.FormUpload=r.extend({init:function(t){var e=t.scope||null,r=x.rescope;this.$input=t.$input;this.url=t.url;this.params=t.params||{};this.successcb=r(t.success,e);this.errorcb=r(t.error,e);this.before=r(t.before,e);this.after=r(t.after,e);this.abortcb=r(t.abort,e);this.aborted=!1;this.$form=null;this.xhr=null},upload:function(){if(!this.aborted){var t=this.url,e=o.param(this.params);e&&(t=t+"?"+e);var r=this.$form=this._renders.form(t),n=this;this._addToBody(r.append(this.$input));r.ajaxForm({dataType:"json",data:this.params,timeout:0,beforeSend:function(t){n.xhr=t},beforeSubmit:function(){n.before()},error:function(t){if(n.aborted)n.abortcb();else{var e=t&&t.responseText||"";n.errorcb(e)}},success:function(t){n.successcb(t||{})},complete:function(){if(n.$form){n.$form.remove();n.$form=null}n.after()}});r.submit()}},abort:function(){if(!this.aborted){this.aborted=!0;if(this.xhr){this.xhr.abort();this.xhr=null}else{this.abortcb();this.after()}}},_addToBody:function(t){o("body").append(t)},_renders:{form:function(t){return o("<form method='post' enctype='multipart/form-data'/>").attr("action",t).hide()}}});x.AjaxUpload=r.extend({init:function(t){var e=t.scope||null,r=x.rescope;this.file=t.file;this.url=t.url;this.params=t.params||{};this.beforecb=r(t.before,e);this.progresscb=r(t.progress,e);this.errorcb=r(t.error,e);this.successcb=r(t.success,e);this.abortcb=r(t.abort,e);this.finalcb=r(t.after,e);this.aborted=!1},upload:function(){if(!this.aborted&&!this.xhr){var t=this.xhr=x.AjaxUpload.xhr();t.upload.onprogress=o.proxy(this._upload,this);t.onreadystatechange=o.proxy(this._statechange,this);var e=this.url,r=o.param(this.params);r&&(e=e+"?"+r);this.beforecb();try{t.open("POST",e,!0);t.setRequestHeader("Content-Type",this.file.type||"application/octet-stream");t.send(this.file)}catch(t){this._clienterror(t,this.file)}}},abort:function(){if(!this.aborted){this.aborted=!0;if(this.xhr)this.xhr.abort();else{this.abortcb();this.finalcb()}}},_statechange:function(){if(4===this.xhr.readyState){if(this.aborted)this.abortcb();else{try{this.successcb(JSON.parse(this.xhr.responseText),this.xhr.status,this.xhr)}catch(t){this.errorcb(this.xhr.responseText,this.xhr.status,this.xhr)}this.xhr.upload.onprogress=this.xhr.statechange=null}this.finalcb()}},_clienterror:function(t,e){this.errorcb(x.AjaxUpload.getClientErrorMessage(t,e),-1,this.xhr);this.finalcb()},_upload:function(t){t.lengthComputable&&this.progresscb(t.loaded)}});o.extend(x.AjaxUpload,{isSupported:function(){return x.AjaxUpload._fileApiSupport(window)&&x.AjaxUpload._xhrSupport()},xhr:function(){var t=x.AjaxUpload._xhrJquery();t||(t=x.AjaxUpload._xhrDirect);x.AjaxUpload.xhr=t;return t()},getClientErrorMessage:function(t,e){var r;try{r=e.name}catch(t){r="<unknown>"}return"NS_ERROR_FILE_ACCESS_DENIED"===t.name?x.Text.tr("upload.error.no.access",r):"NS_ERROR_FILE_NOT_FOUND"===t.name||"NS_ERROR_FILE_TARGET_DOES_NOT_EXIST"===t.name?x.Text.tr("upload.error.does.not.exist",r):x.Text.tr("upload.error.client.unknown",r,t.message||t)},_xhrJquery:function(){var t=o.ajaxSettings;return t&&t.xhr||null},_xhrDirect:function(){try{return new XMLHttpRequest}catch(t){return null}},_xhrSupport:function(){try{var t=x.AjaxUpload.xhr();if(t&&t.upload)return!0}catch(t){}return!1},_fileApiSupport:function(t){return t.File&&t.FileList&&(!i.isMozilla()||t.FileReader)}});x.Timer=r.extend({init:function(t,e){this.callback=x.rescope(t,e||this);this._callback=o.proxy(this._callback,this);this.timeoutId=null},cancel:function(){if(null!==this.timeoutId){this._endTimeout(this.timeoutId);this.timeoutId=null}return this},schedule:function(t){this.cancel();this.timeoutId=this._startTimeout(this._callback,t);return this},_callback:function(){this.timeoutId=null;this.callback()},_startTimeout:function(t,e){return window.setTimeout(t,e)},_endTimeout:function(t){window.clearTimeout(t)}});x.Text=(h=1024,d=1024*(c=1048576),p=Math.floor(1018.88),f=Math.floor(.995*c),m=Math.floor(.995*d),{"upload.empty.file":e.I18n.getText("upload.empty.file"),"upload.too.big":e.I18n.getText("upload.too.big"),"upload.error.bad.response":e.I18n.getText("upload.error.bad.response"),"upload.error.unknown.status":e.I18n.getText("upload.error.unknown.status"),"upload.error.auth":e.I18n.getText("upload.error.auth"),"upload.error.badrequest":e.I18n.getText("upload.error.badrequest"),"upload.error.server":e.I18n.getText("upload.error.server"),"upload.cancel":e.I18n.getText("common.words.cancel"),"upload.file.remaining":e.I18n.getText("upload.file.remaining"),"upload.file.waiting":e.I18n.getText("upload.file.waiting"),"upload.file.stalled":e.I18n.getText("upload.file.stalled"),"upload.checkbox.title":e.I18n.getText("attachfile.attachment.checkbox.title"),"upload.xsrf.timeout":e.I18n.getText("attachment.error.xsrf.expired"),"upload.error.unknown":e.I18n.getText("attachment.error.unknown"),"upload.progress.title.waiting":e.I18n.getText("upload.progress.title.waiting"),"upload.progress.title.running":e.I18n.getText("upload.progress.title.running"),"upload.progress.title.unknown.stalled":e.I18n.getText("upload.progress.title.unknown.stalled"),"upload.progress.title.known":e.I18n.getText("upload.progress.title.known"),"upload.progress.title.known.stalled":e.I18n.getText("upload.progress.title.known.stalled"),"upload.kilobyte":e.I18n.getText("upload.kilobyte"),"upload.kilobyte.part":e.I18n.getText("upload.kilobyte.part"),"upload.megabyte":e.I18n.getText("upload.megabyte"),"upload.megabyte.part":e.I18n.getText("upload.megabyte.part"),"upload.gigabyte":e.I18n.getText("upload.gigabyte"),"upload.gigabyte.part":e.I18n.getText("upload.gigabyte.part"),"upload.seconds":e.I18n.getText("upload.seconds"),"upload.minutes":e.I18n.getText("upload.minutes"),"upload.hours":e.I18n.getText("upload.hours"),"upload.hours.minutes":e.I18n.getText("upload.hours.minutes"),"upload.bytes.per.second":e.I18n.getText("upload.bytes.per.second"),"upload.kilobytes.per.second":e.I18n.getText("upload.kilobytes.per.second"),"upload.megabytes.per.second":e.I18n.getText("upload.megabytes.per.second"),"upload.error.no.access":e.I18n.getText("upload.error.no.access"),"upload.error.does.not.exist":e.I18n.getText("upload.error.does.not.exist"),"upload.error.client.unknown":e.I18n.getText("upload.error.client.unknown"),"upload.error.too.many.files":e.I18n.getText("upload.error.too.many.files"),"upload.error.server.no.reply":e.I18n.getText("upload.error.server.no.reply"),tr:function(t){if(0!==arguments.length){if(1===arguments.length)return this[t]||t;if(this[t]){var r=x.copyArrayLike(arguments);r[0]=this[t];return e.format.apply(AJS,r)}return t}},fileSize:function(){if(0!==arguments.length){var t,e=x.Text._classifySize(arguments[0]);t=e.unit===h?"upload.kilobyte":e.unit===c?"upload.megabyte":"upload.gigabyte";if(1===arguments.length)return this.tr(t,e.convert(arguments[0]));for(var r=new Array(arguments.length),n=0;n<arguments.length;n++)r[n]=this.tr(t,e.convert(arguments[n]));return r}},currentOutOfTotalSize:function(t,e){var r,n=this._classifySize(e);r=n.unit===h?"upload.kilobyte.part":n.unit===c?"upload.megabyte.part":"upload.gigabyte.part";return this.tr(r,n.convert(t),n.convert(e))},_classifySize:function(t){var e;return{unit:e=t<=f?h:t<=m?c:d,convert:function(t){return x.Text._toDisplay(t/e)}}},time:function(t){if(t<60)return this.tr("upload.seconds",Math.floor(t));var e=t/60;if(e<60)return this.tr("upload.minutes",Math.floor(e));var r=Math.floor(e/60);return(e=Math.floor(e%60))>0?this.tr("upload.hours.minutes",r,e):this.tr("upload.hours",r)},rate:function(t){return t<=p?this.tr("upload.bytes.per.second",x.Text._toDisplay(t)):t<=f?this.tr("upload.kilobytes.per.second",x.Text._toDisplay(t/h)):this.tr("upload.megabytes.per.second",x.Text._toDisplay(t/c))},_toDisplay:function(t){return t<.005?"0":(Math.round(100*t)/100).toFixed(2)}});return x}));AJS.namespace("AJS.InlineAttach",null,require("jira/attachment/inline-attach"));