define("jira/viewissue/watchers-voters/views/watchers-view",["require","wrm/context-path"],(function(e,t){"use strict";var r=e("jira/viewissue/watchers-voters/views/abstract-watchers-view"),i=e("jira/util/data/meta"),s=e("underscore"),a=e("jira/util/logger"),c=e("jira/field/multi-user-list-picker"),n=JIRA.Templates.Issue;return r.extend({events:{selected:"addWatcherToModel",unselect:"removeWatcherFromModel"},_render:function(){this.$el.html(n.watchersWithBrowse({watchers:this.collection.toJSON()}));var e=JIRA.Issues.Api.getSelectedIssueKey(),r=new c({element:this.$el.find(".watchers-user-picker"),width:220,ajaxOptions:{url:t()+"/rest/api/1.0/users/picker/filter",data:{issueKey:e}}});this.$el.find(".js-add-watchers-label").attr("for",r.$field.attr("id"))},focus:function(){this.$el.find("#watchers-textarea").focus()},addWatcherToModel:function(e,t){e.preventDefault();this.collection.addWatcher(t.value()).done(s.bind((function(){this._incrementWatcherCount();t.value()===i.get("remote-user")&&this.watch()}),this))},removeWatcherFromModel:function(e,t){this.collection.removeWatcher(t.value()).done(s.bind((function(){this._decrementWatcherCount();if(t.value()===i.get("remote-user")){this.unwatch();a.trace("jira.issue.watcher.deleted")}}),this))}})}));