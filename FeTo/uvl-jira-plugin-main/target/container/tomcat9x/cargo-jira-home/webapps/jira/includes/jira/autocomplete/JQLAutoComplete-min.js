var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("jira/jql/jql-grammar",(function(){"use strict";var e={jql_order_by:[{value:"ORDER BY",displayName:"ORDER BY"}],jql_operators:[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}],jql_logical_operators:[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}]};e.jql_logical_operators_and_order_by=e.jql_logical_operators.concat(e.jql_order_by);e.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];e.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];e.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];e.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];e.jql_changed_predicates=e.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);e.jql_was_predicates_and_order_by=e.jql_was_predicates.concat(e.jql_logical_operators_and_order_by);e.jql_was_predicates_and_logical_operators=e.jql_was_predicates.concat(e.jql_logical_operators);e.jql_changed_predicates_and_order_by=e.jql_changed_predicates.concat(e.jql_logical_operators_and_order_by);e.jql_changed_predicates_and_logical_operators=e.jql_changed_predicates.concat(e.jql_logical_operators);e.REGEXP_ANDS=/^AND\s/i;e.REGEXP_ORS=/^OR\s/i;e.REGEXP_NOTS=/^NOT\s/i;e.REGEXP_SNOT=/^\s+not/i;e.REGEXP_SIN=/^\s+in/i;e.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;e.REGEXP_COMMA_DELIMITER=/^\s*,/;e.REGEXP_ASCENDING=/^\s+asc/i;e.REGEXP_DESCENDING=/^\s+desc/i;e.REGEXP_ORDER_BY=/^order\s+by/i;e.REGEXP_WHITESPACE=/^\s/;e.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;e.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;e.REGEXP_NEW_LINE=/[\r\n]/;e.REGEXP_NUMBER=/\d/;e.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;e.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;e.REGEXP_SPACE_OR_ELSE=/[\s(]/;e.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;e.REGEXP_NOTSTART=/^NO?$/i;e.REGEXP_INSTART=/^IN?$/i;e.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;e.version_field_type="com.atlassian.jira.project.version.Version";e.jql_text_operator_names=["~","!~"];return e}));define("jira/autocomplete/jql-autocomplete",["jira/util/formatter","jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jira/util/users/logged-in-user","jira/featureflags/feature-manager","jquery","underscore","jira/util/logger","wrm/context-path","jira/terminology-feature-service","jira/util/strings"],(function(e,t,r,s,a,n,i,l,o,d,u,g,c,h,p){"use strict";var O=c();return function(c){var f,m=i.begetObject(t),S=c.parser,L=d.grep(c.jqlFieldNames,(function(e){return e.searchable})),C=d.grep(c.jqlFieldNames,(function(e){return e.orderable})),y=c.jqlFunctionNames,N=d("#"+c.errorID),R=0,E=d("#jqlcolumnnum"),I=d("#jqlrownum"),v=c.autoCompleteUrl||O+"/rest/api/2/jql/autocompletedata/suggestions",_=c.suggestionsLimit||15,P=[],j=[];m.textToSuggestionCursorPosition=function(){return m.field.selectionRange().textBefore};m.pushSuggestionsOnHtmlStack=function(e,t,r,s,a){for(var n=Math.min(_,e.length),i=0;i<n;i++){var l,o;if(e[i].value){var d=e[i];l=f&&a?(f.getNeedsOpenParen()?"(":"")+d.value:d.value;o=d.displayName}else l=o=e[i];t.push(l);r.push('<li id="',s,i,'">',o,"</li>")}};m.setAutoSelectFirst=function(e){var t=m.getReplacementStartIndex(f,""),r=m.field.selectionRange().end,s=m.field.val().substring(t,r);m.autoSelectFirst=m.shouldSelectFirstValue(m.field.val(),f,s,e)};m.shouldSelectFirstValue=function(e,t,r,a){return m.isSmartAutoSelectFirstEnabled()?!(0===r.length&&t.getIsInSubmittableState()):!(0===r.length||a&&a.length>0&&s.equalsIgnoreCase(r,a[0][1]))};m.renderSuggestions=function(t,r,s,a){var i=[];if(t instanceof Array){if(t.length<1&&r&&r.length<1&&s&&s.length<1)return i;var l=["<ul>"];s&&s.length>0&&m.pushSuggestionsOnHtmlStack(s,i,l,"jql_operator_suggest_",!1);m.pushSuggestionsOnHtmlStack(t,i,l,"jql_value_suggest_",!0);r&&r.length>0&&m.pushSuggestionsOnHtmlStack(r,i,l,"jql_function_suggest_",!1);l.push("</ul>");var o=d('<span class="esc-prompt">').text(e.I18n.getText("navigator.advanced.query.esc.prompt")),u=d('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",n.get("advanced-search-help-title")).attr("href",n.get("advanced-search-help-url")).text(e.I18n.getText("navigator.advanced.query.syntax")).append(o),c=d('<div class="syntax-help-container">').append(u);m.responseContainer.html(l.join("")).append(c).find("li").each((function(e){i[e]=[d(this),i[e]]}));var h=d(".autocomplete-assistive");h.text()?h.text(e.I18n.getText("navigator.advanced.query.available.options",i.length)):h.text(e.I18n.getText("navigator.advanced.query.instructions",i.length));a&&a.length&&m.renderTerminologyHint(a);m.setAutoSelectFirst(i);m.addSuggestionControls(i);g.trace("jira.jql.suggestions.done")}return i};m.getMatchingTerminologyTerms=function(e){if(!h.isTerminologyActiveForUser())return null;var t=h.getTerminologyEntries(),r=Math.min(_,e.length),a=e.slice(0,r);return t.filter((function(e){return a.find((function(t){return m.startsWithIgnoreCase(e.newName,s.removeBolding(t.displayName))}))}))};m.renderTerminologyHint=function(e){var t=void 0;if(e.length>1){var r=p.toSentenceCase(u.findWhere(e,{originalName:"sprint"}).newNamePlural),s=p.toSentenceCase(u.findWhere(e,{originalName:"epic"}).newNamePlural);t=JIRA.Templates.JQLAutoComplete.terminologyHintMultiple({sprintNewName:r,epicNewName:s})}else{var a=e[0];t=JIRA.Templates.JQLAutoComplete.terminologyHintSingle({originalNamePlural:p.toSentenceCase(a.originalNamePlural),newNamePlural:a.newNamePlural})}m.responseContainer.prepend(t)};m.needsSpaceInCompletion=function(){return!(f.isInsideList()||f.getNeedsOpenParen()||f.getNeedsOrderByDirection())};m.completeField=function(e){var t,r=m.getReplacementStartIndex(f,e),s=m.getReplacementEndIndex(f,r);t=m.needsSpaceInCompletion()?e+" ":e;m.replaceValue(r,s,t);var a=S.parse(m.field.val());m.updateParseIndicator(a)};m._afterCompleteField=function(e){t._afterCompleteField.call(this);m.needsSpaceInCompletion()&&m.dispatcher(m.field.val());return e};m.prepareOperandSuggestions=function(e,t,r,n,i){if(e){var l=R,o=null==i?null===f.getLastOperand()?"":s.stripEscapeCharacters(f.getLastOperand()):i,d=t+":"+o,u={fieldName:s.stripEscapeCharacters(t)};null===f.getLastOperand()&&null===i||(u.fieldValue=o);var g=a.isWasOperator(f.getLastOperator()),c="issuetype"===t||"type"===t;if(m.getSavedResponse(d))m.renderSuggestionsForOperands(o,m.getSavedResponse(d),r,n,l,c);else{m.dropdownController.dropdown.removeClass("dropdown-ready");m.delay((function(){m._makeRequest({url:v,dataType:"json",data:u,success:function(e){var t;t=null!==e&&null!==e.results?e.results:[];if(g){var s=u.fieldValue;t=m.appendEmpty(s,t)}m.saveResponse(d,t);m.renderSuggestionsForOperands(o,t,r,n,l,c)},error:function(){m.renderSuggestionsForOperands(o,[],r,n,l)}})}),m.queryDelay)}}else m.renderSuggestionsForOperands(s.stripEscapeCharacters(f.getLastOperand()),[],r,n,R)};m.preparePredicateSuggestions=function(e,t){void 0===t&&(t=null);var r=m.slimListForPredicates(t,y,e);m.boldMatchingString(t,r);var a=null==t?null===f.getLastOperand()?"":s.stripEscapeCharacters(f.getLastOperand()):t,n=e+":"+a,i={predicateName:s.stripEscapeCharacters(e)};null===f.getLastOperand()&&null===t||(i.predicateValue=a);if(null!==f.getLastFieldName()){i.fieldName=f.getLastFieldName();n=f.getLastFieldName()+":"+n}if(m.predicateSupportsAutoComplete(e))if(m.getSavedResponse(n))m.renderSuggestions(m.getSavedResponse(n),r);else{m.dropdownController.dropdown.removeClass("dropdown-ready");m.delay((function(){m._makeRequest({url:v,dataType:"json",data:i,success:function(e){var t;t=null!==e&&null!==e.results?e.results:[];var s=i.predicateValue;t=m.appendEmpty(s,t);m.saveResponse(n,t);m.renderSuggestions(t,r)},error:function(){m.renderSuggestionsForOperands(a,[])}})}),m.queryDelay)}else m.renderSuggestions([],r)};m.incompleteOperator=function(){var e=f.getTokens();return null===e||e.length<2?"":(e=m.textToSuggestionCursorPosition().split(" ")).length>2?e[e.length-1]:""};m.incompletePredicateValue=function(){var e=f.getTokens();return null===e||e.length<3?"":(e=m.textToSuggestionCursorPosition().split(/[\s(,]+/)).length>3?e[e.length-1]:""};m.appendEmpty=function(e,t){var s=m.slimListForMapResults(e,r.empty_operand,!0);null!=e&&m.boldMatchingString(e,s);t.length<_?t=t.concat(s):t[_-1]=s[0];return t};m.dispatcher=function(e){var t,n,i,l=d(m.field).selectionRange(),o=e.substring(0,l.start),u=S.parse(o);f=u.getResult();R++;if(f.getNeedsField()){i=f.getLastFieldName()||!P.length?L:P;m.renderSuggestionsFromMap(s.stripEscapeCharacters(f.getLastFieldName()),i,r.jql_not_logical_operator,!0)}else if(f.getNeedsOperatorOrOperand()){n=a.isEmptyOnlyOperator(f.getLastOperator())?r.empty_operand:y;u.calcLastOperandStartIndex();var g=u.getParsedOperator(),c=m.getSuggestionsForOperators(g,r.jql_operators);if(c&&c.length>0){var h=m.incompleteOperator();m.prepareOperandSuggestions(!0,f.getLastFieldName(),n,c,h)}}else if(f.getNeedsOperator())m.renderSuggestionsForOperators(f.getLastOperator(),r.jql_operators);else if(f.getNeedsPredicateOperand()){var p=f.getLastWasPredicate();m.preparePredicateSuggestions(p,s.stripEscapeCharacters(f.getLastOperand()))}else if(f.getNeedsLogicalOperator())if(f.getNeedsWasPredicate())if(f.getNeedsOrderBy()){t=null===f.getLastOrderBy()?f.getLastWasPredicate():f.getLastOrderBy();"was"===f.getLastOperator()?m.renderSuggestionsFromMap(t,r.jql_was_predicates_and_order_by,!1):m.renderSuggestionsFromMap(t,r.jql_changed_predicates_and_order_by,!1)}else"was"===f.getLastOperator()?m.renderSuggestionsFromMap(f.getLastWasPredicate(),r.jql_was_predicates_and_logical_operators,!1):m.renderSuggestionsFromMap(f.getLastWasPredicate(),r.jql_changed_predicates_and_logical_operators,!1);else if(f.getNeedsOrderBy()){t=null===f.getLastOrderBy()?f.getLastLogicalOperator():f.getLastOrderBy();m.renderSuggestionsFromMap(t,r.jql_logical_operators_and_order_by,!1)}else m.renderSuggestionsFromMap(f.getLastLogicalOperator(),r.jql_logical_operators,!1);else if(f.getNeedsOrderByField()){i=f.getLastOrderByFieldName()||!j.length?C:j;m.renderSuggestionsFromMap(s.stripEscapeCharacters(f.getLastOrderByFieldName()),i,!0)}else if(f.getNeedsOrderByDirection())m.renderSuggestionsFromMap(f.getLastOrderByDirection(),r.jql_order_by_direction,!1);else if(f.getNeedsOperand()){var O=f.getLastFieldName(),N=!1;if(!a.isEmptyOnlyOperator(f.getLastOperator()))for(var E=d.inArray(f.getLastOperator(),r.jql_text_operator_names)>-1,I=0;I<L.length;I++)if(s.equalsIgnoreCase(s.getUnquotedString(L[I].value),O)||L[I].cfid&&s.equalsIgnoreCase(L[I].cfid,O)){N=m.calculateAutocompleteFlag(E,L[I].types[0],L[I].auto);break}n=a.isEmptyOnlyOperator(f.getLastOperator())?r.empty_operand:y;m.prepareOperandSuggestions(N,O,n,{})}else f.getNeedsOrderBy()?m.renderSuggestionsFromMap(f.getLastOrderBy(),r.jql_logical_operators_and_order_by,!1):m.dropdownController.hideDropdown();m.parse(e)};m.calculateAutocompleteFlag=function(e,t,s){return(!e||void 0===t||t!==r.version_field_type)&&s};m.parse=function(e){var t=S.parse(e);m.updateParseIndicator(t);m.updateColumnLineCount();return t.getResult()};m.renderSuggestionsFromMap=function(e,t,r,s){r||(r={});var a=m.slimListForMapResults(e,t,s),n=m.slimListForMapResults(e,r,s),i=m.getMatchingTerminologyTerms(a);m.boldMatchingString(e,n);m.boldMatchingString(e,a);m.renderSuggestions(a,n,null,i);0===a.length&&0===n.length&&m.dropdownController.hideDropdown()};m.getSuggestionsForOperators=function(e,t){for(var r,a=m.slimListForMapResults(e,t,!1),n=f.getLastFieldName(),i=0;i<L.length;i++)if(s.equalsIgnoreCase(s.getUnquotedString(L[i].value),n)||L[i].cfid&&s.equalsIgnoreCase(L[i].cfid,n)){r=L[i].operators;break}r&&(a=d.grep(a,(function(e){return d.inArray(e.value,r)>-1})));m.boldMatchingString(e,a);return a};m.renderSuggestionsForOperators=function(e,t){var r=m.getSuggestionsForOperators(e,t);m.renderSuggestions(r);0===r.length&&m.dropdownController.hideDropdown()};m.renderSuggestionsForOperands=function(e,t,r,s,a,n){if(a===R){var i=m.slimListForFunctionResults(e,r,f.getLastOperator());m.boldMatchingString(e,i);var l=null;n&&(l=m.getMatchingTerminologyTerms(t));m.renderSuggestions(t,i,s,l);0===t.length&&0===i.length&&0===s.length&&m.dropdownController.hideDropdown()}};m.boldMatchingString=function(e,t){if(null!==e&&0!==t.length){for(var r=e.length,s=0,a=r;s<a;s++)switch(e.charAt(s)){case"<":case">":r+=3;break;case"&":r+=4;break;case'"':r+=5}for(var n=0;n<t.length;n++)if(t[n].displayName){var i=t[n].displayName;t[n]={value:t[n].value,displayName:"<b>"+i.substring(0,r)+"</b>"+i.substring(r)}}else t[n]={value:t[n],displayName:"<b>"+t[n].substring(0,r)+"</b>"+t[n].substring(r)}}};m.getReplacementStartIndex=function(e,t){var r,s=d(m.field);return null!=(r=e.getNeedsField()?e.getLastFieldNameStartIndex():e.getNeedsOperatorOrOperand()?e.getNeedsOperator()&&a.isWasOperator(t)?e.getLastOperatorStartIndex():e.getLastOperandStartIndex():e.getNeedsOperand()?e.getLastOperandStartIndex():e.getNeedsOperator()?e.getLastOperatorStartIndex():e.getNeedsOrderByField()?e.getLastOrderByFieldNameStartIndex():e.getNeedsOrderByDirection()?e.getLastOrderByDirectionStartIndex():e.getNeedsPredicateOperand()?e.getLastOperandStartIndex():e.getNeedsLogicalOperator()?null!==e.getLastLogicalOperatorStartIndex()&&0!==e.getLastLogicalOperatorStartIndex()?e.getLastLogicalOperatorStartIndex():null!==e.getLastOrderBy()&&0!==e.getLastOrderByStartIndex()?e.getLastOrderByStartIndex():null!=e.getLastWasPredicate()&&0!==e.getLastWasPredicateStartIndex()?e.getLastWasPredicateStartIndex():!0===e.getMustBeOperatorOrPredicate()?s.selectionRange().start:s.selectionRange().start-1:e.getNeedsWasPredicate()?e.getLastWasPredicateStartIndex():e.getNeedsOrderBy()?e.getLastOrderByStartIndex():s.selectionRange().start-1)?r:s.selectionRange().start};m.getReplacementEndIndex=function(e,t){var s=d(m.field).selectionRange(),a=null;if(s.start===s.end&&s.end!==m.field.val().length&&t<s.start){var n=e.getTokens().length-1,i=S.parse(m.field.val()).getResult().getTokens()[n];if(null!==i&&"("!==i&&")"!==i){for(var l=m.field.val(),o=l.substring(t,l.length).split(""),u=0,g=0;g<o.length&&r.REGEXP_WHITESPACE.test(o[g]);g++)u++;a=t+i.length+u}}null===a&&(a=s.end);if(a<t){m.replaceValue(t,a," ");a=t}return a};m.replaceValue=function(e,t,r){var s=d(m.field);s.selectionRange(e,t);d.browser.webkit?document.execCommand("insertText",!1,r):s.selection(r);var a=s.selectionRange().end;s.selectionRange(a,a)};m.slimListForMapResults=function(e,t,r){var a=s.htmlEscape(e),n=d.grep(t,(function(e){return s.startsWithIgnoreCaseNullsMeanAll(a,e.displayName)}));return r||1!==n.length||s.startsWithNotEqualsIgnoreCaseNullMeansAll(a,n[0].displayName)?n:{}};m.slimListForFunctionResults=function(e,t,n){for(var i,l=f.getLastFieldName(),o=0;o<L.length;o++)if(s.equalsIgnoreCase(s.getUnquotedString(L[o].value),l)||L[o].cfid&&s.equalsIgnoreCase(L[o].cfid,l)){i=L[o].types;break}var u=d.grep(t,(function(t){if(t.isList&&!a.isListSupportingOperator(n)||!t.isList&&a.isListSupportingOperator(n))return!1;if(!i)return!1;var l=d.inArray("java.lang.Object",t.types)>-1||d.inArray("java.lang.Object",i)>-1;if(d.inArray(n,r.jql_text_operator_names)>-1&&d.inArray(r.version_field_type,i)>-1)return l;for(var o=0;o<i.length&&!l;o++)l=-1!==d.inArray(i[o],t.types);return!!l&&(s.startsWithIgnoreCaseNullsMeanAll(e,t.value)||s.startsWithIgnoreCaseNullsMeanAll(e,t.displayName))}));return 1!==u.length||s.startsWithNotEqualsIgnoreCaseNullMeansAll(e,u[0].displayName)?u:{}};m.slimListForPredicates=function(e,t,a){for(var n,i,l=0;l<r.jql_changed_predicates.length;l++)if(s.equalsIgnoreCase(s.getUnquotedString(r.jql_changed_predicates[l].value),a)){n=r.jql_changed_predicates[l].type;i=r.jql_changed_predicates[l].supportsList;break}var o=d.grep(t,(function(t){return(void 0===t.isList||!(t.isList&&i||!t.isList&&i))&&(!!(-1!==d.inArray(n,t.types))&&(s.startsWithIgnoreCaseNullsMeanAll(e,t.value)||s.startsWithIgnoreCaseNullsMeanAll(e,t.displayName)))}));return 1!==o.length||s.startsWithNotEqualsIgnoreCaseNullMeansAll(e,o[0].displayName)?o:{}};m.predicateSupportsAutoComplete=function(e){for(var t,a=0;a<r.jql_changed_predicates.length;a++)if(s.equalsIgnoreCase(s.getUnquotedString(r.jql_changed_predicates[a].value),e)){t=r.jql_changed_predicates[a].auto;break}return t};m.getSavedResponse=function(e){this.requested||(this.requested={});return this.requested[e]};m.saveResponse=function(e,t){if("string"==typeof e&&"object"===(void 0===t?"undefined":_typeof(t))){this.requested||(this.requested={});this.requested[e]=t}};m.startsWithIgnoreCase=function(e,t){return!(null===t||null===e||t.length<e.length)&&e.toLowerCase()===t.substr(0,e.length).toLowerCase()};m.updateParseIndicator=function(t){var r=d(".autocomplete-assistive"),s=e.I18n.getText("navigator.advanced.query.correct"),a=e.I18n.getText("navigator.advanced.query.incorrect"),n=function(e){return r.text().includes(e)};if(t.getParseError()){N.attr("title",t.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror");t.getResult().lastFieldName&&!n(a)&&r.append(a)}else{N.attr("title","").removeClass("jqlerror").addClass("jqlgood");t.getResult().lastFieldName&&!n(s)&&r.append(s)}};m.updateColumnLineCount=function(){var e=d(m.field),t=0;if(m.field[0]===document.activeElement){t=e.selectionRange().start}else t=m.field[0].value.length;for(var s=1,a=1,n=m.field.val(),i=0;i<t;i++)if(r.REGEXP_NEW_LINE.test(n.charAt(i))){s++;a=1}else a++;E.text(a);I.text(s)};m.isSuggestRecentFieldsEnabled=function(){return o.isFeatureEnabled("jira.jql.suggestrecentfields")};m.isSmartAutoSelectFirstEnabled=function(){return o.isFeatureEnabled("jira.jql.smartautoselectfirst")};m.init(c);if(m.isSuggestRecentFieldsEnabled()){var x=null,q=function(e){var t=e.value.sort();P=d.grep(L,(function(e){return u.contains(t,s.getUnquotedString(e.value))}));j=d.grep(C,(function(e){return u.contains(t,s.getUnquotedString(e.value))}))},W=function(){l.isAnonymous()||d.ajax({url:O+"/rest/api/2/user/properties/jqlValues?username="+l.username()}).done(q)};q(s.getRecentFields());x=setInterval(W,5e3);m.field.focus((function(){W();x||(x=setInterval(W,5e3))})).blur((function(){if(x){clearInterval(x);x=null}}))}return m}}));define("jira/jql/util",["jira/jql/jql-grammar","wrm/data"],(function(e,t){"use strict";var r={htmlEscape:function(e){if(null===e)return null;for(var t="",r=e.split(""),s=0;s<r.length;s++)"<"===r[s]?t+="&lt;":">"===r[s]?t+="&gt;":"&"===r[s]?t+="&amp;":'"'===r[s]?t+="&quot;":t+=r[s];return t},stripEscapeCharacters:function(t){if(null===t)return t;for(var r="",s=t.split(""),a=0;a<s.length&&("\\"!==s[a]||e.REGEXP_UNICODE.test(t.substring(a,t.length))||!(++a>=t.length));a++)r+=s[a];return r},equalsIgnoreCase:function(e,t){return null===e&&null===t||null!==e&&e.toLowerCase()===t.toLowerCase()},removeBolding:function(e){return e.replace(/<\/?b>/g,"")},startsWithIgnoreCaseNullsMeanAll:function(e,t){return null===t||null===e||!(t.length<e.length)&&e.toLowerCase()===t.substr(0,e.length).toLowerCase()},startsWithNotEqualsIgnoreCaseNullMeansAll:function(t,r){if(null===r||null===t)return!0;if(r.length<t.length)return!1;if(t.toLowerCase()===r.substr(0,t.length).toLowerCase()){var s=null;s=e.REGEXP_FIELD_NAME.test(r.substr(t.length,r.length))?r.substr(0,t.length):r;return t.toLowerCase()!==s.toLowerCase()}return!1},getRecentFields:function(){void 0===r.recentValues&&(r.recentValues=t.claim("jira.core:jqlautocomplete-data.jql.autocomplete.recentFields"));return r.recentValues},getUnquotedString:function(e){var t=null!=e&&e.length>=3&&"\\"!==e.charAt(e.length-2);null!=e&&'"'===e.charAt(0)?'"'===(e=e.substring(1,e.length)).charAt(e.length-1)&&t&&(e=e.substring(0,e.length-1)):null!=e&&"'"===e.charAt(0)&&"'"===(e=e.substring(1,e.length)).charAt(e.length-1)&&t&&(e=e.substring(0,e.length-1));return e}};return r}));define("jira/jql/operator-util",(function(){"use strict";var e={isListSupportingOperator:function(e){return"in"===e||"not in"===e||"was not in"===e||"was in"===e},isEmptyOnlyOperator:function(e){return"is"===e||"is not"===e},isWasOperator:function(e){return"was"===e||"was in"===e||"was not in"===e||"was not"===e},isChangedOperator:function(e){return"changed"===e},isHistoryOperator:function(t){return e.isWasOperator(t)||e.isChangedOperator(t)}};return e}));define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jira/jql/util","jquery"],(function(e,t,r,s,a){"use strict";return function(n){var i=n;return{parse:function(e){var r=t();r.init(e);this.jql(r);return r},orderByClause:function(t){var r=t.remainingString(),s=r.match(e.REGEXP_ORDER_BY);if(s){var a=r.substring(0,s[0].length);t.consumeCharacters(a.length);t.getResult().setLastOrderBy(a,t);if(t.isComplete()){t.getResult().resetLogicalOperators();t.setParseError()}else{r=t.remainingString();if(e.REGEXP_WHITESPACE.test(r)){this.chewWhitespace(t);this.orderByFields(t)}else{t.getResult().resetLogicalOperators();t.setParseError()}}}else{t.consumeCharacters(r.length);t.getResult().setLastOrderBy(r,t);t.setParseError()}},orderByFields:function(e){this.orderByField(e);this.chewWhitespace(e);if(e.isComplete())e.getResult().getNeedsOrderByField()||e.getResult().setLastOrderByDirection("",e);else{var t=e.remainingString();if(this.startsWithIgnoreCase(",",t)){e.consumeCharacter();this.orderByFields(e);this.chewWhitespace(e)}else{null!==(t=e.remainingString())&&e.consumeCharacters(t.length);e.getResult().setNeedsOrderByDirection();e.getResult().setLastOrderByDirection(t,e);e.setParseError()}}},orderByField:function(t){this.chewWhitespace(t);var r=this.fieldName(t);if(0!==r.length){t.getResult().setLastOrderByFieldName(r,t);var s=t.remainingString();if(t.isComplete()||e.REGEXP_COMMA_DELIMITER.test(s)){t.getResult().setNeedsOrderByField();this.chewWhitespace(t)}else if(e.REGEXP_ASCENDING.test(s)){this.chewWhitespace(t);t.consumeCharacters(3);t.getResult().setLastOrderByDirection("asc",t);t.getResult().setNeedsOrderByComma()}else if(e.REGEXP_DESCENDING.test(s)){this.chewWhitespace(t);t.consumeCharacters(4);t.getResult().setLastOrderByDirection("desc",t);t.getResult().setNeedsOrderByComma()}else t.getResult().setNeedsOrderByDirection()}else{t.getResult().setLastOrderByFieldName("",t);t.getResult().setNeedsOrderByField();t.setParseError()}},jql:function(e){this.orClause(e);var t=e.remainingString();this.startsWithIgnoreCase("ord",t)&&this.orderByClause(e);e.result.setInsideList(0!==e.inListParens)},orClause:function(t){for(;!t.isComplete()&&!this.startsWithIgnoreCase(")",t.remainingString());){this.chewWhitespace(t);var r=t.remainingString();if(this.startsWithIgnoreCase("ord",r))break;if(t.getResult().getMustBeOperatorOrPredicate())t.getResult().resetLastPredicates();else{t.getResult().resetLogicalOperators();this.andClause(t)}if(!t.isComplete()&&null===t.getResult().getLastLogicalOperator()){t.getResult().getNeedsWasPredicate()&&this.predicateClause(t);if(t.isComplete())return;r=t.remainingString();if(this.startsWithIgnoreCase("ord",r))break;if(null!==r&&(e.REGEXP_ORS.test(r)||this.startsWithIgnoreCase("|",r)||this.startsWithIgnoreCase("||",r))){if(this.startsWithIgnoreCase("||",r)){t.getResult().setLastLogicalOperator("||",t.getTokenStringIdx());t.consumeCharacters(2)}else if(e.REGEXP_ORS.test(r)){t.getResult().setLastLogicalOperator("OR",t.getTokenStringIdx());t.consumeCharacters(3)}else{t.getResult().setLastLogicalOperator("|",t.getTokenStringIdx());t.consumeCharacters(1)}t.getResult().resetTerminalClause();t.isComplete()&&t.setParseError();t.getResult().setNeedsField()}else if(!this.startsWithIgnoreCase(")",r)||!t.getInParens()){this.chewWhitespace(t);var s,a=null===r?t.getMaxTokenStringIdx():t.getMaxTokenStringIdx()-r.length;if(null!=r){s=r.split(" ");t.getResult().setLastLogicalOperator(s[0],a);t.getResult().setLastWasPredicate(s[0],t);t.getResult().setNeedsLogicalOperator(t)}if(null===t.getResult().getLastWasOperator())t.setParseError();else{if(null===s)return;if(e.REGEXP_PREDICATE.test(s[0])){t.getResult().setLastLogicalOperator(null);t.getResult().resetNeedsPredicateOperand()}else{if(e.REGEXP_ANDS.test(r)){t.consumeCharacters(4);t.getResult().resetTerminalClause();t.getResult().setNeedsField()}(t.isComplete()||1===s.length)&&t.setParseError()}}}}}},andClause:function(t){this.chewWhitespace(t);this.notClause(t);if(!t.isComplete()&&null===t.getResult().getLastLogicalOperator()){this.chewWhitespace(t);var r=t.remainingString();if(null!==r&&(e.REGEXP_ANDS.test(r)||this.startsWithIgnoreCase("&",r)||this.startsWithIgnoreCase("&&",r))){if(this.startsWithIgnoreCase("&&",r)){t.getResult().setLastLogicalOperator("&&",t.getTokenStringIdx());t.consumeCharacters(2)}else if(this.startsWithIgnoreCase("&",r)){t.getResult().setLastLogicalOperator("&",t.getTokenStringIdx());t.consumeCharacters(1)}else{t.getResult().setLastLogicalOperator("AND",t.getTokenStringIdx());t.consumeCharacters(4)}t.getResult().resetTerminalClause();t.isComplete()&&t.setParseError();t.getResult().setNeedsField()}else{t.getResult().setNeedsLogicalOperator(t);t.isComplete()&&t.getResult().setLastLogicalOperator(null,t.getMaxTokenStringIdx())}}},notClause:function(t){this.chewWhitespace(t);if(t.isComplete()){this.terminalClause(t);t.setParseError()}else{this.chewWhitespace(t);var r=t.remainingString();if(null!==r&&(e.REGEXP_NOTS.test(r)||this.startsWithIgnoreCase("!",r))){t.getResult().needsField=!1;if(this.startsWithIgnoreCase("!",r)){t.getResult().setLastLogicalOperator("!",t.getTokenStringIdx());t.consumeCharacters(1)}else{t.getResult().setLastLogicalOperator("NOT",t.getTokenStringIdx());t.consumeCharacters(4)}t.getResult().resetTerminalClause();t.isComplete()&&t.setParseError();t.getResult().setNeedsField()}else this.terminalClause(t)}},predicateClause:function(e){this.chewWhitespace(e);if(e.isComplete())e.setParseError();else{var t=e.remainingString(),r=t.split(/[\s(]+/);if(null!==t){e.getResult().setMustBeOperatorOrPredicate(!1);if(this.startsWithLogicalOperator(t)){if(1===r.length){e.getResult().setLastWasPredicate(r[0],e);e.setParseError();return}return}e.getResult().resetNeedsPredicateOperand();e.consumeCharacters(r[0].length);e.getResult().setLastWasPredicate(r[0],e);if(1===r.length){e.setParseError();return}if(this.wasPredicateComplete(r[0])){e.getResult().setNeedsPredicateOperand();e.getResult().setLastOperand(null,e);this.predicateOperand(e)}else e.setParseError()}}},predicateOperand:function(e){this.chewWhitespace(e);var t=this.collectPredicateOperands(e);if(null==t||""==t){e.getResult().setLastOperandStartIndex(e.getTokenStringIdx());e.setParseError()}if(null!=e.remainingString()){e.getResult().resetNeedsPredicateOperand();e.getResult().resetLastPredicates();e.getResult().setMustBeOperatorOrPredicate(!0);e.getResult().setNeedsLogicalOperator(e);this.chewWhitespace(e)}},collectPredicateOperands:function(e){"DURING"===e.getResult().getLastWasPredicate()&&e.getResult().setNeedsOpenParen(!0);var t=this.listOperand(e,!0);0===t.length&&0===(t=this.functionOperand(e)).length?t=this.singleValueOperand(e):e.getResult().setNeedsOpenParen(!1);return s.getUnquotedString(t)},terminalClause:function(t){t.getResult().resetTerminalClause();this.chewWhitespace(t);var r=t.remainingString();if(this.startsWithIgnoreCase("(",r)){t.getResult().addToken("(");t.setInParens();t.consumeCharacter();this.orClause(t);this.chewWhitespace(t);r=t.remainingString();if(this.startsWithIgnoreCase(")",r)){t.getResult().addToken(")");t.consumeCharacter();t.setOutOfParens();if(t.isComplete()){t.getResult().resetLogicalOperators();t.getResult().resetLastPredicates()}}else t.setParseError()}else{this.field(t);if(t.isComplete()){t.getResult().setNeedsField();t.setParseError();return}this.oper(t);if(t.isComplete()){if("was"===t.getResult().getLastOperator()||"was not"===t.getResult().getLastOperator())t.getResult().setNeedsOperandOrOperator();else{if("changed"===t.getResult().getLastWasOperator()){var s=t.currentCharacter();if(null!==s&&e.REGEXP_SPACE_OR_ELSE.test(s))t.getResult().setNeedsLogicalOperator(t);else{t.getResult().resetLogicalOperators();t.getResult().setNeedsOrderBy(!1)}return}t.getResult().setNeedsOperator()}t.setParseError()}else{if("changed"===t.getResult().getLastWasOperator()){t.getResult().setNeedsLogicalOperator(t);return}this.operand(t);if(t.getResult().getOperandComplete()){var a=t.getResult().getLastWasOperator();t.getResult().setNeedsNothing();a&&t.getResult().setLastWasOperator(a)}else t.isComplete()&&!t.getResult().getNeedsListComma()&&t.getResult().setNeedsOperand()}}},field:function(e){var t=this.fieldName(e);if(0!==t.length)e.getResult().setLastFieldName(t,e);else if(null===e.getResult().getLastFieldName()){var r=e.remainingString();e.getResult().setNeedsField();e.getResult().setLastFieldName(r,e);e.setParseError()}},fieldName:function(e){this.chewWhitespace(e);var t=e.remainingString();if(this.startsWithIgnoreCase("cf",t)){var r=e.getTokenStringIdx(),s=e.remainingString();e.consumeCharacters(2);this.chewWhitespace(e);t=e.remainingString();if(this.startsWithIgnoreCase("[",t)){e.consumeCharacter();t=e.remainingString();if(0!==this.numberValue(e).length){this.chewWhitespace(e);t=e.remainingString();if(this.startsWithIgnoreCase("]",t)){e.consumeCharacter();return s.substring(0,e.getTokenStringIdx()-r)}}}e.setParseError();return s}return this.startsWithIgnoreCase("issue.property",t)?this.entityPropertyName("issue.property",e):this.fieldOrFunctionName(e)},entityPropertyName:function(e,t){t.consumeCharacters(e.length);this.chewWhitespace(t);var r=t.remainingString();if(this.startsWithIgnoreCase("[",r)){t.consumeCharacter();for(var s=[this.stringValue(t)];!t.parseError&&this.startsWithIgnoreCase(".",t.remainingString());){t.consumeCharacter();s[s.length]=this.stringValue(t)}if(0!==s.length&&0!==s[0].length&&!this.startsWithIgnoreCase(".",s[0])){this.chewWhitespace(t);r=t.remainingString();if(this.startsWithIgnoreCase("]",r)){t.consumeCharacter();for(var a=[this.stringValue(t)];!t.parseError&&this.startsWithIgnoreCase(".",t.remainingString());){t.consumeCharacter();a[a.length]=this.stringValue(t)}return e+"["+s.join(".")+"]"+a.join(".")}}}t.setParseError();return""},oper:function(t){this.chewWhitespace(t);var s=t.remainingString(),a=this.getLongestOperatorMatch(s,e.jql_operators);if(null!==a){t.getResult().setLastOperator(a,t.getTokenStringIdx());(r.isWasOperator(a)||r.isChangedOperator(a))&&t.getResult().setLastWasOperator(a);t.consumeCharacters(a.length);if("in"===a||"is"===a||"is not"===a||"not in"===a||"was"===a||"was not"===a||"was in"===a||"was not in"===a){var n=t.currentCharacter();null===n||e.REGEXP_SPACE_OR_ELSE.test(n)||t.setParseError()}if("was"===a){t.getResult().setNeedsOperandOrOperator();this.chewWhitespace(t);null!=(s=t.remainingString())&&(e.REGEXP_NOTSTART.test(s)||e.REGEXP_INSTART.test(s))&&t.setParseError()}else if("was not"===a){t.getResult().setNeedsOperandOrOperator();this.chewWhitespace(t);null!=(s=t.remainingString())&&e.REGEXP_INSTART.test(s)&&t.setParseError()}else"changed"===a?t.getResult().setNeedsLogicalOperator(t):t.getResult().setNeedsOperand()}else if(null===t.getResult().getLastOperator()){var i=null===s?t.getMaxTokenStringIdx():t.getMaxTokenStringIdx()-s.length;t.getResult().setLastOperator(s,i);t.getResult().setNeedsOperator();t.setParseError()}},operand:function(e){this.chewWhitespace(e);"in"!==e.getResult().getLastOperator()&&"not in"!==e.getResult().getLastOperator()&&"was not in"!==e.getResult().getLastOperator()&&"was in"!==e.getResult().getLastOperator()||e.getResult().setNeedsOpenParen(!0);var t=this.listOperand(e,!0);if(0===t.length){t=this.functionOperand(e);0===t.length?t=this.singleValueOperand(e):e.getResult().setNeedsOpenParen(!1)}else e.getResult().setNeedsOpenParen(!1);if(null===t||0===t.length){var r=e.remainingString();e.getResult().setLastOperand(r,e);e.getResult().setNeedsOperand();e.setParseError()}return 0!==t.length?t:""},singleValueOperand:function(e){var t=this.stringValue(e);if(0!==t.length){e.getResult().setLastOperand(t,e);"empty"!==t.toLowerCase()&&"null"!==t.toLowerCase()&&this.isReservedWord(t.toLowerCase())&&e.setParseError();return t}return""},functionOperand:function(e){var t=e.getTokenStringIdx(),r=this.fieldOrFunctionName(e);this.chewWhitespace(e);var s=this.listOperand(e,!1);if(0!==r.length&&0!==s.length){var a=r+s;e.getResult().setLastOperand(a,e);return a}e.backTrackToIdx(t);return""},listOperand:function(e,t){if("("===e.currentCharacter()){e.consumeCharacter();e.setInListParens();var r="("+this.collectListValues(e,t);this.chewWhitespace(e);if(")"===e.currentCharacter()){e.consumeCharacter();e.setOutOfListParens();"()"===(r+=")")&&t&&e.getResult().setLastOperand(r,e);if(t){e.getResult().setOperandComplete();e.getResult().resetNeedsPredicateOperand()}}else e.setParseError();return r}return""},collectListValues:function(e,t){t&&e.getResult().setNeedsOperand();this.chewWhitespace(e);var r=t?this.operand(e):this.stringValue(e);if(0!==r.length){this.chewWhitespace(e)&&t&&e.getResult().setNeedsListComma();if(","===e.currentCharacter()){e.consumeCharacter();var s=this.collectListValues(e,t);0===s.length&&e.setParseError();return r+", "+s}return r}return""},startsWithIgnoreCase:function(e,t){return!(null===t||null===e||t.length<e.length)&&e.toLowerCase()===t.substr(0,e.length).toLowerCase()},startsWithLogicalOperator:function(e){return null!==e&&(this.startsWithOr(e)||this.startsWithAnd(e)||this.startsWithNot(e)||this.startsWithBraces(e))},startsWithOr:function(e){return this.startsWithIgnoreCase("|",e)||this.startsWithIgnoreCase("||",e)||this.startsWithIgnoreCase("or",e)},startsWithAnd:function(e){return this.startsWithIgnoreCase("&",e)||this.startsWithIgnoreCase("&&",e)||this.startsWithIgnoreCase("and",e)},startsWithNot:function(e){return this.startsWithIgnoreCase("!",e)||this.startsWithIgnoreCase("not",e)},startsWithBraces:function(e){return this.startsWithIgnoreCase("(",e)||this.startsWithIgnoreCase(")",e)},chewWhitespace:function(t){for(var r=!1,s=t.currentCharacter();null!==s&&e.REGEXP_WHITESPACE.test(s);){t.consumeCharacter();s=t.currentCharacter();r=!0}return r},getLongestOperatorMatch:function(t,r){var s,a=null;this.startsWithIgnoreCase("is",t)&&(a=(s=t.substring(2).match(e.REGEXP_SNOT))?t.substring(0,s[0].length+2):"is");if(this.startsWithIgnoreCase("was",t))a=(s=t.substring(3).match(e.REGEXP_SNOT_IN))?t.substring(0,s[0].length+3):"was";else if(this.startsWithIgnoreCase("not",t)){var n=t.substring(3).match(e.REGEXP_SIN);n&&(a=t.substring(0,n[0].length+3))}else for(var i=0;i<r.length;i++)this.startsWithIgnoreCase(r[i].value,t)&&(null===a||e.jql_operators[i].value.length>a)&&(a=e.jql_operators[i].value);return a},getValueMinusExtraWhitespace:function(t){if(null===t)return null;for(var r="",s=!0,a=t.split(""),n=0;n<a.length;n++){var i=a[n];if(e.REGEXP_WHITESPACE.test(i)){if(s){s=!1;r+=i}}else{s=!0;r+=i}}return r},fieldOrFunctionName:function(e){var t=this.stringValue(e);'""'!==t&&"''"!==t||e.setParseError();this.isReservedWord(t.toLowerCase())&&e.setParseError();return t},isReservedWord:function(e){return-1!==a.inArray(e,i)},stringValue:function(t){for(var r="",s=!1,a=!1,n=t.currentCharacter();null!==n&&(s||a||e.REGEXP_TOKEN_CHAR.test(n));){r+=n;t.consumeCharacter();if("\\"===n){if(null===(n=t.currentCharacter())){t.setParseError();break}if(e.REGEXP_CHARS_TO_ESCAPE.test(n)){var i=t.remainingString();if(!e.REGEXP_UNICODE.test(i)){t.setParseError();break}}r+=n;t.consumeCharacter()}else{if(e.REGEXP_SPECIAL_CHAR.test(n)&&!s&&!a){t.setParseError();break}'"'!==n||a?"'"!==n||s||(a=!a):s=!s}n=t.currentCharacter()}t.isComplete()&&(s||a)&&t.setParseError();return r},numberValue:function(t){var r="";this.chewWhitespace(t);for(var s=t.currentCharacter();null!==s&&e.REGEXP_NUMBER.test(s);){r+=s;t.consumeCharacter();s=t.currentCharacter()}return r},wasPredicateComplete:function(t){for(var r=!1,s=e.jql_changed_predicates.length,a=0;a<s;++a)if(t.toLowerCase()===e.jql_changed_predicates[a].value.toLowerCase()){r=!0;break}return r}}}}));define("jira/jql/jql-parse-result",["jira/jql/util"],(function(e){"use strict";return function(){var t=[],r=0;return{getTokens:function(){return t},addToken:function(e){t[r++]=e},setLastFieldName:function(s,a){this.fieldNameStartIndex=null===s?a.getMaxTokenStringIdx():a.getTokenStringIdx()-s.length;this.lastFieldName=e.getUnquotedString(s);t[r++]=s},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(s,a){this.orderByFieldNameStartIndex=null===s?a.getMaxTokenStringIdx():a.getTokenStringIdx()-s.length;this.lastOrderByFieldName=e.getUnquotedString(s);this.lastOrderByDirection=null;t[r++]=s},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(e,s){this.orderByDirectionStartIndex=null===e?s.getMaxTokenStringIdx():s.getTokenStringIdx()-e.length;this.lastOrderByDirection=e;t[r++]=e},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!0;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1;this.needsWasPredicate=!1;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!1;this.needsOrderByField=!0;this.needsOrderByDirection=!1;this.lastOrderByDirection=null;this.needsListComma=!1},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!0;this.needsListComma=!1},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1},setNeedsListComma:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!0},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(e,s){this.lastOperator=e;this.operatorStartIndex=s;t[r++]=e},setLastWasOperator:function(e){this.lastWasOperator=e},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(s,a){this.operandStartIndex=null===s?a.getMaxTokenStringIdx():a.getTokenStringIdx()-s.length;this.lastOperand=e.getUnquotedString(s);t[r++]=s},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=!1;this.needsOperator=!1;this.needsLogicalOperator=!1;this.needsOperand=!0;this.needsOrderBy=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1},setNeedsOperandOrOperator:function(){this.needsField=!1;this.needsOperator=!0;this.needsLogicalOperator=!1;this.needsOperand=!0;this.needsOrderBy=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=!0;this.needsLogicalOperator=!1;this.needsOrderBy=!1},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=!1;this.needsOperand=!1},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(e){this.operandStartIndex=e},setLastLogicalOperator:function(e,s){this.lastLogicalOperator=e;this.logicalOperatorStartIndex=s;t[r++]=e},setNeedsOperator:function(){this.needsField=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsOperator=!0;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(e){this.needsLogicalOperator=!0;this.needsOperator=!1;this.needsOperand=!1;this.needsField=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsListComma=!1;this.needsOrderBy=!e.getInParens();null!=this.lastWasOperator&&(this.needsWasPredicate=!0)},setNeedsOpenParen:function(e){this.needsOpenParen=e},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(e){this.needsOrderBy=e},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(e,s){this.wasPredicateStartIndex=null===e?s.getMaxTokenStringIdx():s.getTokenStringIdx()-e.length;this.lastWasPredicate=e;t[r++]=e},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(e,s){this.orderByStartIndex=null===e?s.getMaxTokenStringIdx():s.getTokenStringIdx()-e.length;this.lastOrderBy=e;t[r++]=e},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(t){e.getUnquotedString(t)},setParseError:function(e){this.parseError=!0;this.parseErrorMsg=e},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=!1;this.needsOperand=!1;this.needsLogicalOperator=!1;this.needsOrderBy=!1;this.needsField=!1;this.needsOrderByField=!1;this.needsOrderByDirection=!1;this.needsOpenParen=!1;this.needsListComma=!1;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=!0},getOperandComplete:function(){return this.operandComplete},setInsideList:function(e){this.insideList=e},isInsideList:function(){return this.insideList},setMustBeOperatorOrPredicate:function(e){this.mustBeOperatorOrPredicate=e},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},getIsInSubmittableState:function(){return 0===t.length||1===t.length&&null===t[0]||this.getNeedsLogicalOperator()||this.getNeedsOrderBy()||this.getNeedsOrderByDirection()},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=!1;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null;this.insideList=null;this.setNeedsField()}}}}));define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],(function(e){"use strict";return function(){return{init:function(t){this.tokenStringIdx=0;this.tokenString=t;this.parseError=!1;this.parseErrorMsg=null;this.result=e();this.result.init();this.inParens=0;this.inListParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(e){this.tokenStringIdx=this.tokenStringIdx+e},backTrackToIdx:function(e){this.tokenStringIdx=e;this.parseError=!1;this.parseErrorMsg=null;this.result.parseError=!1;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){return this.tokenStringIdx>=this.tokenString.length?null:this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){return this.tokenStringIdx>=this.tokenString.length?null:this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){return!!this.parseError||this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){0!==this.inParens&&this.inParens--},getInParens:function(){return 0!==this.inParens},setInListParens:function(){this.inListParens++},setOutOfListParens:function(){this.inListParens>0&&this.inListParens--},getInListParens:function(){return this.inListParens>0},setParseError:function(){this.parseError=!0;var e=this.tokenStringIdx-9<0?0:this.tokenStringIdx-9,t=this.tokenString.substring(e,this.tokenStringIdx-1);this.result.setParseError("..."+t+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var e=this.getResult(),t=e.getLastOperator();if(t.length>0){var r=t.length-t.replace(/\s+/g,"").length;e.setLastOperandStartIndex(e.getLastOperatorStartIndex()+t.length+r+1)}},getParsedOperator:function(){var e=this.getResult();return e.getLastOperator().length>0?this.tokenString.substr(e.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}}));AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));