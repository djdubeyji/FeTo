AJS.test.require("jira.webresources:init-on-dcl",(function(){"use strict";var e=function(e){Object.defineProperty(window.document,"readyState",{writable:!0,value:e})};module("jira/util/on-load",{setup:function(){this.onLoad=require("jira/util/init-on-dcl");this.cachedReadyState=document.readyState;this.sandbox=sinon.sandbox.create()},teardown:function(){this.sandbox.restore();e(this.cachedReadyState)}});test("Event listener is being attached when document is in loading phase",(function(){e("loading");var t=this.sandbox.spy(),n=this.sandbox.spy(document,"addEventListener");this.onLoad(t);equal(t.callCount,0,"onLoad callback doesn't fire");equal(n.callCount,1,"DOMContentLoaded listener has been attached")}));test("Callback is being called when document is in interactive phase",(function(t){e("interactive");var n=this.sandbox.spy(),a=t.async();this.onLoad(n);setTimeout((function(){equal(n.callCount,1,"onLoad callback does fire");a()}),1)}));test("Callback is being called when document loaded (complete)",(function(t){e("complete");var n=this.sandbox.spy(),a=t.async();this.onLoad(n);setTimeout((function(){equal(n.callCount,1,"onLoad callback does fire");a()}),1)}))}));