AJS.test.require(["jira.webresources:searchers"],(function(){"use strict";var e=this,t=require("jira/util/formatter"),s=require("jira/searchers/element/status-picker-options"),a=["test 1","test 2","3 test"],o={baseAjaxOptions:{projectIds:["560","450"],issueTypeIds:["123"]}};module("statusPickerOptions",{setup:function(){e.sandbox=sinon.sandbox.create();e.sandbox.stub(t,"format",(function(e){return e}));e.createStatus=function(e,t){return{id:t,iconUrl:"http://url/"+t,name:e,html:""+e}};e.createStatuses=function(t){return{values:a.map(e.createStatus),total:t||a.length}}},teardown:function(){e.sandbox.restore()}});test("should setup ajax options",(function(){var e=s(o);ok(e.ajaxOptions,"ajaxOptions defined");ok(e.ajaxOptions.url,"REST endpoint path defined");equal(e.ajaxOptions.data.maxResults,100,"maxResults query param is set to default value");equal(e.ajaxOptions.data.projectIds,o.baseAjaxOptions.projectIds,"projectIds query param is set");equal(e.ajaxOptions.data.issueTypeIds,o.baseAjaxOptions.issueTypeIds,"issueTypeIds query param is set");ok(!e.query,"Uses debouncing");ok("function"==typeof e.ajaxOptions.formatResponse,"formatResponse method defined")}));test("should keep input options",(function(){var e={test1:"test 1 option",test2:2,test3:!1},t=s(Object.assign(o,e));equal(t.test1,e.test1,"keep string property");equal(t.test2,e.test2,"keep numeric property");equal(t.test3,e.test3,"keep boolean property")}));test("should format response",(function(){var t=e.createStatuses(),a=s(o).ajaxOptions.formatResponse(t);t.values.forEach((function(e){return ok(a[0].items().some((function(t){return t.value()===e.id&&t.label()===e.name})),"should format response for status id:"+e.id+", name:"+e.name)}));ok(!0===a[0].fetchedThroughAjaxCall(),"marked as ajax call response")}));test("should create HTML element with proper attributes",(function(){var t=e.createStatuses(),a=s(o).ajaxOptions.formatResponse(t)[0].items()[0].model();ok("OPTION"===a[0].nodeName,"should be option element");ok(a.hasClass("imagebacked"),"should contain imgagebacked class");ok(a.data("icon")===t.values[0].iconUrl,"should contain proper data-icon attribute");ok(a[0].innerText===t.values[0].name,"should contain proper innerText value")}));test("should include footer text when number of statuses returned was trimmed",(function(){var t=e.createStatuses(5),a=s(o).ajaxOptions.formatResponse(t);ok("common.concepts.too.many.matches"===a[0].footerText(),"footer text is set with proper translation key")}));test("should omit footer text when all projects were returned",(function(){var t=e.createStatuses(),a=s(o).ajaxOptions.formatResponse(t);ok(!a[0].footerText(),"footer text is not set")}))}));