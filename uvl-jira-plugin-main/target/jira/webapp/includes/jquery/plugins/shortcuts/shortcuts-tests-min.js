AJS.test.require(["jira.webresources:key-commands"],(function(){var e=require("jquery");module("Sequenced Shortcut Events",{teardown:function(){e(document).unbind("shortcut")}});test('"shortcut" event fires for single character shortcut',(function(){var e=new r("x");n("x");equal(e.valueOf(),1,'Shortcut "x" event fires for input stream [x]')}));test('"shortcut" event fires for multi-character shortcut sequence',(function(){var e=new r("xyz");n("x");n("y");n("z");equal(e.valueOf(),1,'Shortcut "xyz" event fires for input stream [x,y,z]')}));test('"shortcut" event does not fire for non-matching character sequences',(function(){var e=new r("xyz");n("z");n("x");n("z");n("x");n("y");n("y");n("z");equal(e.valueOf(),0,'Shortcut "xyz" event does not fire for input stream [z,x,z,x,y,y,z]')}));test("Conflicting shortcut sequences do not throw errors",(function(){e(document).bind("shortcut","xyz",e.noop);e(document).bind("shortcut","xy",e.noop);e(document).bind("shortcut","y",e.noop);e(document).bind("shortcut","xyzy",e.noop);expect(0)}));test('"shortcut" event only fires for longest matching sequence',(function(){var e=new r("yz"),t=new r("xyz");n("x");n("y");n("z");equal(e.valueOf(),0,'Shortcut "yz" event does not fire for input stream [x,y,z]');equal(t.valueOf(),1,'Shortcut "xyz" event fires for input stream [x,y,z]')}));test("Input stream resets after a completed shortcut",(function(){var e=new r("zy"),t=new r("xyz");n("z");n("x");n("y");n("z");n("y");equal(e.valueOf(),0,'Shortcut "zy" does not fire for input stream [z,x,y,z,y]');equal(t.valueOf(),1,'Shortcut "xyz" fires for input stream [z,x,y,z,y]')}));test("Input stream resets after a non-character key is pressed",(function(){var e=new r("xy");n("x");t(17);t(89);n("y");equal(e.valueOf(),0,"CTRL key resets input stream");var o=new r("xz");n("x");t(16);t(90);n("z");equal(o.valueOf(),1,"SHIFT key does not reset input stream")}));test('Key events targeted at form element do not fire "shortcut" events',(function(){var e=new r("xy"),t=document.getElementById("qunit-fixture").appendChild(document.createElement("textarea"));n("x",document);n("y",t);n("x",t);n("y",t);equal(e.valueOf(),0,'Key events targeted at <textarea> do not fire "shortcut" event');n("x",t);n("y",document);equal(e.valueOf(),0,"Key events targeted at <textarea> reset the character input stream")}));function t(t,n){e(n||document).trigger({type:"keydown",keyCode:t,which:t})}function n(t,n){e(n||document).trigger({type:"keypress",which:t.charCodeAt(0)})}function r(t){var n=0;this.valueOf=function(){return n};e(document).bind("shortcut",t,(function(){n++}))}}));