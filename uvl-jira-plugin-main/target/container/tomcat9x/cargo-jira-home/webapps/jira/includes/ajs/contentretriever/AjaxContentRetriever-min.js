define("jira/ajs/contentretriever/ajax-content-retriever",["jira/ajs/contentretriever/content-retriever","jira/ajs/ajax/smart-ajax","jquery"],(function(t,e,i){"use strict";return t.extend({init:function(t){this.ajaxOptions=t;this.ajaxOptions.requestDelay||0===this.ajaxOptions.requestDelay||(this.ajaxOptions.requestDelay=75)},getAjaxOptions:function(){var t,e=this;(t="string"==typeof this.ajaxOptions?{url:this.ajaxOptions}:i.isFunction(this.ajaxOptions)?this.ajaxOptions():this.ajaxOptions).globalThrobber=!1;t.success=function(t,i,s){e._requestComplete(s,i,t,!0,null)};t.error=function(t,i){t.rc&&(t.status=t.rc);e._requestComplete(t,i,null,!1,null)};return t},content:function(t){if(i.isFunction(t)){this.callback=t;this._makeRequest(t)}else if(t&&this.callback){this.callback(t);delete this.callback}return this.$content},startingRequest:function(t){if(t)this.startingCallback=t;else if(this.startingCallback){this.locked=!0;this.startingCallback()}},finishedRequest:function(t){if(t)this.finishedCallback=t;else if(this.finishedCallback){this.locked=!1;this.finishedCallback()}},failedRequest:function(t){if(t)this.failedCallback=t;else if(this.failedCallback){this.locked=!1;this.failedCallback()}},cache:function(t){void 0!==t&&(this.getAjaxOptions().cache=t);return this.getAjaxOptions().cache},isLocked:function(){return this.locked},_requestComplete:function(t,s,a,n){if("abort"!==s){var r,o,u=this.getAjaxOptions();e.SmartAjaxResult&&(o=e.SmartAjaxResult.apply(window,arguments));if(n)r=i.isFunction(u.formatSuccess)?u.formatSuccess(a):i("<div>"+a+"</div>");else{if(i.isFunction(u.formatError))r=u.formatError(a);else if(o){var l=401===o.status?"aui-message-warning":"aui-message-error";r=i('<div class="aui-message '+l+'">'+e.buildSimpleErrorContent(o)+"</div>")}this.failedRequest()}this.content(r);this.finishedRequest()}else this.locked=!1},_makeRequest:function(){var t=this;if(this.outstandingRequest){this.outstandingRequest.abort();this.outstandingRequest=null}clearTimeout(this._queuedRequest);this.isLocked()?this._queuedRequest=setTimeout((function(){t._makeRequest()}),this.ajaxOptions.requestDelay):function(){t.startingRequest();t.outstandingRequest=i.ajax(t.getAjaxOptions())}()}})}));AJS.namespace("AJS.AjaxContentRetriever",null,require("jira/ajs/contentretriever/ajax-content-retriever"));